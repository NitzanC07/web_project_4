!function(){"use strict";class e{constructor(e,t){this._settings=e,this._formElement=document.querySelector(`${t}`)}_showErrorMessage(e,t){const{inputErrorClass:s,errorClass:r}=this._settings;this._errorElement=this._formElement.querySelector(`.${e.id}-error`),this._errorElement.textContent=t,this._errorElement.classList.add(s),e.classList.add(r)}_hideErrorMessage(e){const{inputErrorClass:t,errorClass:s}=this._settings;this._errorElement=this._formElement.querySelector(`.${e.id}-error`),this._errorElement.textContent="",this._errorElement.classList.remove(t),e.classList.remove(s)}_checkInputValidity(e){if(e.validity.valid)this._hideErrorMessage(e);else{const t=e.validationMessage;this._showErrorMessage(e,t)}}_inputsList(){const{inputSelector:e}=this._settings;return Array.from(this._formElement.querySelectorAll(e))}_selectButton(){const{submitButtonSelector:e}=this._settings;return this._formElement.querySelector(e)}_toggleButtonState(){const{inactiveButtonClass:e}=this._settings,t=this._selectButton();this._inputsList().some((e=>!e.validity.valid))?(t.classList.add(e),t.setAttribute("disabled",!0)):(t.classList.remove(e),t.removeAttribute("disabled"))}_setEventListeners(){this._inputsList().forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{})),this._setEventListeners()}resetValidation(){const{inactiveButtonClass:e}=this._settings,t=this._selectButton();t.classList.add(e),t.setAttribute("disabled","true"),this._inputsList().forEach((e=>{this._hideErrorMessage(e)}))}}var t=class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}renderer(){this._items.forEach((e=>{const t=this._renderer(e);this.addItem(t)}))}addItem(e){this._container.prepend(e)}};const s=document.querySelector("#card-template").content,r=".cards__container",i={inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disable",inputErrorClass:"popup__input_type_error",errorClass:"popup__input_error-visible"},n=".popup_type_avatar",o=document.querySelector(".profile__name"),a=document.querySelector(".profile__avatar-picture"),l=document.querySelector(".profile__description"),d=document.querySelector(".popup__input_content_name"),c=document.querySelector(".popup__input_content_description"),_=document.querySelector(".popup__image"),h=document.querySelector(".popup__image-description");var u=class{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this._handleClosePopupwWithOverlay=this._handleClosePopupwWithOverlay.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleClosePopupwWithOverlay(e){e.target.classList.contains("popup_open")&&this.close()}setEventListeners(){this._popup.querySelector(".popup__close-button").addEventListener("click",(()=>{this.close()}))}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._handleClosePopupwWithOverlay)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("mousedown",this._handleClosePopupwWithOverlay)}},p=class extends u{constructor(e,t){super(e),this._submitHandler=t,this._form=this._popup.querySelector(".popup__form")}getInputsValues(){const e=Array.from(this._form.querySelectorAll(".popup__input")),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._form.querySelector(".popup__submit-button").textContent="Saving...",this._submitHandler()}))}close(){super.close(),this._form.querySelector(".popup__submit-button").textContent="Save",this._form.reset()}};const m=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject(e.statusText))).catch((e=>console.log(e))),v=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}getInitialCards(){return m(`${this._baseUrl}/cards`,{headers:this._headers,method:"GET"})}getUserInfo(){return m(`${this._baseUrl}/users/me`,{headers:this._headers,method:"GET"})}changeAvatar(e){return m(`${this._baseUrl}/users/me/avatar`,{headers:this._headers,method:"PATCH",body:JSON.stringify(e)})}setUserInfo(e){return m(`${this._baseUrl}/users/me`,{headers:this._headers,method:"PATCH",body:JSON.stringify(e)})}createCard(e){return m(`${this._baseUrl}/cards`,{headers:this._headers,method:"POST",body:JSON.stringify(e)})}deleteCard(e){return m(`${this._baseUrl}/cards/${e}`,{headers:this._headers,method:"DELETE"})}likeCard(e){return m(`${this._baseUrl}/cards/likes/${e}`,{headers:this._headers,method:"PUT"})}dislikeCard(e){return m(`${this._baseUrl}/cards/likes/${e}`,{headers:this._headers,method:"DELETE"})}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"38a23878-64ce-4abb-ae0d-d30d11cc9a38","Content-Type":"application/json"}});let b;const E=new class extends u{open(e){super.open(),_.src=e.link,_.alt=e.name,h.textContent=e.name}}(".popup_type_image");E.setEventListeners();const C=new e(i,".popup__form_profile"),y=new e(i,".popup__form_add-card"),k=new e(i,n);C.enableValidation(),y.enableValidation(),k.enableValidation(),v.getInitialCards().then((e=>{new t({items:e,renderer:L},r).renderer()})),v.getUserInfo().then((e=>{console.log("profile detailes from reload page: ",e),f.setUserInfo({name:e.name,about:e.about}),f.setUserAvatar(e.avatar),b=e._id}));const g=new class extends u{setAction(e){this._submitHandler=e}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler(),this.close()}))}}(".popup_type_delete-card");g.setEventListeners();const L=e=>{const t=new class{constructor({data:e,handleCardClick:t,handleDeleteCard:s,handleLikeIcon:r},i,n){this._template=i,this._name=e.name,this._link=e.link,this._ownerId=e.owner._id,this._handleCardClick=t,this._handleLikeIcon=r,this._handleDeleteCard=s,this._userId=n,this._likes=e.likes,this._cardId=e._id}_setEventListeners(){this._card.querySelector(".cards__like-button").addEventListener("click",(()=>this._handleLikeIcon(this._cardId,this._userId,this._likes))),this._card.querySelector(".cards__delete-button").addEventListener("click",(()=>this._handleDeleteCard(this._userId))),this._ownerId!==this._userId&&(this._card.querySelector(".cards__delete-button").style.display="none");const e={name:this._name,link:this._link};this._card.querySelector(".cards__image").addEventListener("click",(()=>{this._handleCardClick(e)}))}removeCard(){this._card.remove(),this._card=null}likeCard(e){this._likes=e,this._card.querySelector(".cards__like-button").classList.add("cards__like-button_active"),this._card.querySelector(".cards__likes-counter").textContent=this._likes.length}dislikeCard(e){this._likes=e,this._card.querySelector(".cards__like-button").classList.remove("cards__like-button_active"),this._card.querySelector(".cards__likes-counter").textContent=this._likes.length}createCard(){const e=this._template.querySelector(".cards__card").cloneNode(!0),t=e.querySelector(".cards__image");return t.setAttribute("src",this._link),t.setAttribute("alt",this._name),e.querySelector(".cards__header").textContent=this._name,this._card=e,this._card.querySelector(".cards__likes-counter").textContent=this._likes.length,this._likes.some((e=>e._id===this._userId))&&this.likeCard(this._likes),this._setEventListeners(),this._card}}({data:e,handleCardClick:()=>{E.open(e)},handleLikeIcon:(e,s,r)=>{r.find((e=>e._id===s))?v.dislikeCard(e).then((e=>{t.dislikeCard(e.likes),console.log("Removed like from card: ",e.likes)})):v.likeCard(e).then((e=>{t.likeCard(e.likes),console.log("Added like to card: ",e.likes)}))},handleDeleteCard:()=>{g.open(),g.setAction((()=>{v.deleteCard(e._id).then((e=>{console.log("card is deleted",e),t.removeCard()}))}))}},s,b);return t.createCard()},f=new class{constructor(e,t,s){this._name=e,this._job=t,this._avatar=s}getUserInfo(){return{name:this._name.textContent,about:this._job.textContent}}setUserInfo(e){this._name.textContent=e.name,this._job.textContent=e.about}setUserAvatar(e){this._avatar.style=`background-image: url(${e});`}}(o,l,a),S=new p(".popup_type_edit-profile",(()=>{let e=S.getInputsValues();f.setUserInfo(e),v.setUserInfo(e).then((e=>{console.log("res",e)})),S.close()}));S.setEventListeners(),document.querySelector(".profile__edit-button").addEventListener("click",(()=>{S.open();const e=f.getUserInfo(o,l);d.value=e.name,c.value=e.about,C.resetValidation()}));const q=new p(n,(()=>{let e=q.getInputsValues();v.changeAvatar(e).then((e=>{f.setUserAvatar(e.avatar)})),q.close()}));q.setEventListeners(),document.querySelector(".profile__avatar").addEventListener("click",(()=>{q.open(),C.resetValidation()}));const I=new p(".popup_type_add-card",(()=>{const e=I.getInputsValues();v.createCard(e).then((e=>{new t({item:e,renderer:L},r).addItem(L(e)),I.close()}))}));I.setEventListeners(),document.querySelector(".profile__add-button").addEventListener("click",(()=>{I.open(),y.resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVNDLGNBQWMseUJBQy9CaUMsaUJBQWlCLFNBQVMsS0FDdkN5SSxFQUFpQm5HLE9BQ2pCLE1BQU1zRyxFQUFXNUMsRUFBU3ZCLFlBQVlyRCxFQUFhRSxHQUNuREMsRUFBVTBCLE1BQVEyRixFQUFTNUYsS0FDM0J4QixFQUFpQnlCLE1BQVEyRixFQUFTM0MsTUFDbENOLEVBQWtCeEYscUJBR3BCLE1BQU0wSSxFQUFjLElBQUlILEVBQWN2SCxHQUEyQixLQUMvRCxJQUFJMkgsRUFBWUQsRUFBWWhHLGtCQUU1QnNCLEVBQUlPLGFBQWFvRSxHQUNkdEYsTUFBTUMsSUFDTHVDLEVBQVNFLGNBQWN6QyxFQUFJMEMsV0FFL0IwQyxFQUFZM0csV0FFZDJHLEVBQVl4RyxvQkFFV3ZFLFNBQVNDLGNBQWMsb0JBQy9CaUMsaUJBQWlCLFNBQVMsS0FDdkM2SSxFQUFZdkcsT0FDWnFELEVBQWtCeEYscUJBSXBCLE1BQU00SSxFQUFtQixJQUFJTCxFTGhHUSx3QktnRzZCLEtBQ2hFLE1BQU1oSSxFQUFPcUksRUFBaUJsRyxrQkFFOUJzQixFQUFJYSxXQUFXdEUsR0FDWjhDLE1BQUt3RixJQUNVLElBQUlsRCxFQUFRLENBQUVrRCxLQUFBQSxFQUFNM0ksU0FBVTBGLEdBQWM5RSxHQUNwREwsUUFBUW1GLEVBQVdpRCxJQUN6QkQsRUFBaUI3RyxjQUl2QjZHLEVBQWlCMUcsb0JBRU92RSxTQUFTQyxjQUFjLHdCQUMvQmlDLGlCQUFpQixTQUFTLEtBQ3hDK0ksRUFBaUJ6RyxPQUNqQnNELEVBQXFCekYscUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LW1haW4vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQtbWFpbi8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC1tYWluLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LW1haW4vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQtbWFpbi8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQtbWFpbi8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC1tYWluLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQtbWFpbi8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LW1haW4vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LW1haW4vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC1tYWluLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gU3ByaW50IDcgLSBwcm9qZWN0IExpdmUgQ29kaW5nLCBMaXphIC0gdGltZSBvbiB2aWRlbzogMDowMCAtIDQwOjAwIG1pbnMuXHJcblxyXG5jbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCR7Zm9ybUVsZW1lbnR9YCk7XHJcbiAgfVxyXG5cclxuICBfc2hvd0Vycm9yTWVzc2FnZShpbnB1dCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JDbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XHJcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcclxuICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKGVycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVFcnJvck1lc3NhZ2UoaW5wdXQpIHtcclxuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgIHRoaXMuX2Vycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0LmlkfS1lcnJvcmApO1xyXG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKGVycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCkge1xyXG4gICAgaWYgKCFpbnB1dC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgICAgdGhpcy5fc2hvd0Vycm9yTWVzc2FnZShpbnB1dCwgZXJyb3JNZXNzYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVFcnJvck1lc3NhZ2UoaW5wdXQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2lucHV0c0xpc3QoKSB7XHJcbiAgICBjb25zdCB7IGlucHV0U2VsZWN0b3IgfSA9IHRoaXMuX3NldHRpbmdzO1xyXG4gICAgY29uc3QgaW5wdXRzTGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoaW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICByZXR1cm4gaW5wdXRzTGlzdDtcclxuICB9XHJcblxyXG4gIF9zZWxlY3RCdXR0b24oKSB7XHJcbiAgICBjb25zdCB7IHN1Ym1pdEJ1dHRvblNlbGVjdG9yIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgIGNvbnN0IGJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgcmV0dXJuIGJ1dHRvbjtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGNvbnN0IHsgaW5hY3RpdmVCdXR0b25DbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XHJcbiAgICBjb25zdCBidXR0b24gPSB0aGlzLl9zZWxlY3RCdXR0b24oKTtcclxuICAgIGNvbnN0IGlucHV0TGlzdCA9IHRoaXMuX2lucHV0c0xpc3QoKTtcclxuICAgIGNvbnN0IGlzRm9ybUludmFsaWQgPSBpbnB1dExpc3Quc29tZShcclxuICAgICAgKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxyXG4gICAgKTtcclxuICAgIGlmICghaXNGb3JtSW52YWxpZCkge1xyXG4gICAgICBidXR0b24uY2xhc3NMaXN0LnJlbW92ZShpbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgYnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCB0cnVlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIGNvbnN0IGlucHV0c0xpc3QgPSB0aGlzLl9pbnB1dHNMaXN0KCk7XHJcbiAgICBpbnB1dHNMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge30pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIGNvbnN0IHsgaW5hY3RpdmVCdXR0b25DbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XHJcbiAgICBjb25zdCBidXR0b24gPSB0aGlzLl9zZWxlY3RCdXR0b24oKTtcclxuICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgYnV0dG9uLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwidHJ1ZVwiKTtcclxuICAgIGNvbnN0IGlucHV0c0xpc3QgPSB0aGlzLl9pbnB1dHNMaXN0KCk7XHJcbiAgICBpbnB1dHNMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlRXJyb3JNZXNzYWdlKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IEZvcm1WYWxpZGF0b3IgfTtcclxuIiwiY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWMgbWV0aG9kIHRoYXQgcmVuZGVycyBhbGwgZWxlbWVudHMgb24gdGhlIHBhZ2UuXHJcbiAgcmVuZGVyZXIoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChkYXRhKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmQgPSB0aGlzLl9yZW5kZXJlcihkYXRhKTtcclxuICAgICAgdGhpcy5hZGRJdGVtKGNhcmQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWMgbWV0aG9kIHRoYXQgdGFrZXMgYSBET00gZWxlbWVudCBhbmQgYWRkcyBpdCB0byB0aGUgY29udGFpbmVyLlxyXG4gIGFkZEl0ZW0oY2FyZEVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGNhcmRFbGVtZW50KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFNlY3Rpb247XHJcbiIsIi8vIGltcG9ydCBoYXZhbmEgZnJvbSAnLi4vaW1hZ2VzL2hhdmFuYS5qcGcnO1xyXG4vLyBpbXBvcnQgdmluYWxlcyBmcm9tICcuLi9pbWFnZXMvdmluYWxlcy5qcGcnO1xyXG4vLyBpbXBvcnQgcGVsaWNhbiBmcm9tICcuLi9pbWFnZXMvcGVsaWNhbi5qcGcnXHJcbi8vIGltcG9ydCBhcmRlYUhlcm9kaWFzIGZyb20gJy4uL2ltYWdlcy9hcmRlYS1oZXJvZGlhcy5qcGcnO1xyXG4vLyBpbXBvcnQgdmlld0Zyb21NYW5hcmEgZnJvbSAnLi4vaW1hZ2VzL3ZpZXctZnJvbS1tYW5hcmEuanBnJztcclxuLy8gaW1wb3J0IGJpcml5YUZvcmVzdCBmcm9tICcuLi9pbWFnZXMvYmlyaXlhLWZvcmVzdC5qcGcnO1xyXG5cclxuLy8gSW5pdGlhbGl6YXRpb24gY2FyZHMgb24gbG9hZGluZyBwYWdlLlxyXG4vLyBleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiT2xkaWVzIGNhcnMgaW4gSGF2YW5hLCBDdWJhLlwiLFxyXG4vLyAgICAgbGluazogaGF2YW5hXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIlRvYmFjY28gZmllbGQgaW4gVmnDsWFsZXMgdmFsbGV5LCBDdWJhLlwiLFxyXG4vLyAgICAgbGluazogdmluYWxlc1xyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJQZWxpY2FuIGluIGEgbGFrZSwgU2FyYXNvdGEgRkwsIFVTQS5cIixcclxuLy8gICAgIGxpbms6IHBlbGljYW5cclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiR3JlYXQgYmx1ZSBoZXJvbiwgU2FyYXNvdGEgRkwsIFVTQS5cIixcclxuLy8gICAgIGxpbms6IGFyZGVhSGVyb2RpYXNcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiU2lnaHQgZnJvbSBNYW5hcmEgdG8gc291dGhlcm4gTGViYW5vbiBpbiB3aW50ZXIgLCBJc3JhZWwuXCIsXHJcbi8vICAgICBsaW5rOiB2aWV3RnJvbU1hbmFyYVxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJCaXJpeWEgZm9yZXN0LCBaZWZhdCwgSXNyYWVsXCIsXHJcbi8vICAgICBsaW5rOiBiaXJpeWFGb3Jlc3RcclxuLy8gICB9XHJcbi8vIF07XHJcblxyXG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQ7XHJcbmV4cG9ydCBjb25zdCBjYXJkc0NvbnRhaW5lciA9IFwiLmNhcmRzX19jb250YWluZXJcIjtcclxuXHJcbi8vIEZvcm0gVmFsaWRhdGlvbiBjbGFzc2VzLlxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fc3VibWl0LWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX3N1Ym1pdC1idXR0b25fZGlzYWJsZVwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X2Vycm9yLXZpc2libGVcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRm9ybVBvcHVwID0gXCIucG9wdXBfX2Zvcm1fcHJvZmlsZVwiO1xyXG5leHBvcnQgY29uc3QgY2hhbmdlQXZhdGFyUG9wdXBTZWxlY3RvciA9IFwiLnBvcHVwX3R5cGVfYXZhdGFyXCI7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRm9ybVBvcHVwU2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZVwiO1xyXG5leHBvcnQgY29uc3QgY2FyZEZvcm1Qb3B1cCA9IFwiLnBvcHVwX19mb3JtX2FkZC1jYXJkXCI7XHJcbmV4cG9ydCBjb25zdCBjYXJkRm9ybVBvcHVwU2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX2FkZC1jYXJkXCI7XHJcbmV4cG9ydCBjb25zdCBwb3B1cEZvckRlbGV0ZUNhcmQgPSBcIi5wb3B1cF90eXBlX2RlbGV0ZS1jYXJkXCI7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhclBpY3R1cmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1waWN0dXJlXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwb3B1cE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF9jb250ZW50X25hbWVcIik7XHJcbmV4cG9ydCBjb25zdCBwb3B1cERlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wb3B1cF9faW5wdXRfY29udGVudF9kZXNjcmlwdGlvblwiXHJcbik7XHJcblxyXG4vLyBJbWFnZSBwb3B1cC5cclxuZXhwb3J0IGNvbnN0IHBvcHVwVHlwZUltYWdlU2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX2ltYWdlXCI7XHJcbi8vIGV4cG9ydCBjb25zdCBwb3B1cFR5cGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9pbWFnZVwiKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwSW1hZ2VEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucG9wdXBfX2ltYWdlLWRlc2NyaXB0aW9uXCJcclxuKTtcclxuIiwiY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3Ioe2RhdGEsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlRGVsZXRlQ2FyZCwgaGFuZGxlTGlrZUljb259LCBjYXJkVGVtcGxhdGUsIHVzZXJJZCkge1xyXG4gICAgdGhpcy5fdGVtcGxhdGUgPSBjYXJkVGVtcGxhdGU7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VJY29uID0gaGFuZGxlTGlrZUljb247XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkID0gaGFuZGxlRGVsZXRlQ2FyZDtcclxuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuICAgIHRoaXMuX2NhcmRJZCA9IGRhdGEuX2lkO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gTGlrZSBidXR0b25zLlxyXG4gICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUxpa2VJY29uKHRoaXMuX2NhcmRJZCwgdGhpcy5fdXNlcklkLCB0aGlzLl9saWtlcykpO1xyXG5cclxuICAgIC8vIERlbGV0ZSBidXR0b25zLlxyXG4gICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19kZWxldGUtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcy5fdXNlcklkKSk7XHJcbiAgICBpZih0aGlzLl9vd25lcklkICE9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19kZWxldGUtYnV0dG9uXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTaG93IGltYWdlIGFzIHBvcHVwLlxyXG4gICAgY29uc3QgY2FyZERhdGEgPSB7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfTtcclxuICAgIHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19faW1hZ2VcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKGNhcmREYXRhKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG4gICAgXHJcbiAgcmVtb3ZlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkID0gbnVsbDtcclxuICB9XHJcblxyXG4gIGxpa2VDYXJkKG5ld0xpa2VzKSB7XHJcbiAgICB0aGlzLl9saWtlcyA9IG5ld0xpa2VzO1xyXG4gICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saWtlLWJ1dHRvblwiKS5jbGFzc0xpc3QuYWRkKFwiY2FyZHNfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlrZXMtY291bnRlclwiKS50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICB9XHJcbiAgZGlzbGlrZUNhcmQobmV3TGlrZXMpIHtcclxuICAgIHRoaXMuX2xpa2VzID0gbmV3TGlrZXM7XHJcbiAgICB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpa2UtYnV0dG9uXCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkc19fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saWtlcy1jb3VudGVyXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlQ2FyZCgpIHtcclxuICAgIGNvbnN0IGNhcmQgPSB0aGlzLl90ZW1wbGF0ZVxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgY29uc3QgaW1nID0gY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19pbWFnZVwiKTtcclxuICAgIGltZy5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdGhpcy5fbGluayk7XHJcbiAgICBpbWcuc2V0QXR0cmlidXRlKFwiYWx0XCIsIHRoaXMuX25hbWUpO1xyXG5cclxuICAgIGNvbnN0IGNhcmRUaXRsZSA9IGNhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19faGVhZGVyXCIpO1xyXG4gICAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICB0aGlzLl9jYXJkID0gY2FyZDtcclxuICAgIHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlrZXMtY291bnRlclwiKS50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aCBcclxuICAgIFxyXG4gICAgbGV0IGlzTGlrZWQgPSB0aGlzLl9saWtlcy5zb21lKHBlcnNvbiA9PiBwZXJzb24uX2lkID09PSB0aGlzLl91c2VySWQpXHJcbiAgICBpZiAoaXNMaWtlZCkge1xyXG4gICAgICB0aGlzLmxpa2VDYXJkKHRoaXMuX2xpa2VzKVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhcmQ7XHJcbiIsImNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9oYW5kbGVDbG9zZVBvcHVwd1dpdGhPdmVybGF5ID1cclxuICAgICAgdGhpcy5faGFuZGxlQ2xvc2VQb3B1cHdXaXRoT3ZlcmxheS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgLy8gUHJpdmF0ZSBtZXRob2QgdGhhdCBjbG9zZSBwb3B1cCB3aW5kb3cgYnkgRXNjYXBlIGtleS5cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZlbnQpIHtcclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gUHJpdmF0ZSBtZXRob2QgdGhhdCBjbG9zZSBwb3B1cCB3aW5kb3cgYnkgY2xpY2tpbmcgb24gdGhlIG92ZXJsYXkuXHJcbiAgX2hhbmRsZUNsb3NlUG9wdXB3V2l0aE92ZXJsYXkoZXZlbnQpIHtcclxuICAgIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfb3BlblwiKSkge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWMgbWV0aG9kIHRoYXQgYWRkcyBhbiBldmVudCBsaXN0ZW5lciB0byB0aGUgY2xvc2UgaWNvbiBvZiB0aGUgcG9wdXAuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlLWJ1dHRvblwiKTtcclxuXHJcbiAgICBjbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYyBtZXRob2QgdGhhdCBvcGVuIHRoZSBwb3B1cCB3aW5kb3cuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVDbG9zZVBvcHVwd1dpdGhPdmVybGF5KTtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYyBtZXRob2QgdGhhdCBjbG9zZSB0aGUgcG9wdXAgd2luZG93LlxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5cIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZUNsb3NlUG9wdXB3V2l0aE92ZXJsYXkpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXA7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBzdWJtaXRIYW5kbGVyKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTsgLy8gdGhpcy5fcG9wdXBcclxuICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIgPSBzdWJtaXRIYW5kbGVyO1xyXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XHJcbiAgfVxyXG5cclxuICAvLyBQcml2YXRlIG1ldGhvZCB3aGljaCBjb2xsZWN0IGRhdGEgZnJvbSBhbGwgdGhlIGlucHV0IGZpZWxkcy5cclxuICBnZXRJbnB1dHNWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dHMgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIikpO1xyXG4gICAgY29uc3QgaW5wdXRzVmFsdWVzID0ge307XHJcbiAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXRzVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbnB1dHNWYWx1ZXM7XHJcbiAgfVxyXG5cclxuICAvLyBNb2RpZmllcyB0aGUgcGFyZW50IG1ldGhvZCBhbmQgYWRkIGV2ZW50IGxpc3RlbmVyIHRvIGNsb3NlIGljb24gYW5kIHN1Ym1pdCBidXR0b24uXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc3VibWl0LWJ1dHRvblwiKS50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gTW9kaWZpZXMgdGhlIHBhcmVudCBtZXRob2QgaW4gb3JkZXIgdG8gcmVzZXQgdGhlIGZvcm0gb25jZSB0aGUgcG9wdXAgaXMgY2xvc2VkLlxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc3VibWl0LWJ1dHRvblwiKS50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoRm9ybTtcclxuIiwiY29uc3QgY3VzdG9tRmV0Y2ggPSAodXJsLCBoZWFkZXJzKSA9PlxyXG4gIGZldGNoKHVybCwgaGVhZGVycylcclxuICAgIC50aGVuKHJlcyA9PiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1c1RleHQpKVxyXG4gICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG5cclxuY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKHtiYXNlVXJsLCBoZWFkZXJzfSkge1xyXG4gICAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICB9XHJcblxyXG4gIC8vIG90aGVyIG1ldGhvZHMgZm9yIHdvcmtpbmcgd2l0aCB0aGUgQVBJXHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIG1ldGhvZDogJ0dFVCcgLy8gZGVmYXVsdCBvcHRpb25cclxuICAgIH0pXHJcbiAgfVxyXG4gIFxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgbWV0aG9kOiAnR0VUJ1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGNoYW5nZUF2YXRhcihuZXdBdmF0YXIpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkobmV3QXZhdGFyKVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKGRhdGEpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGNyZWF0ZUNhcmQoZGF0YSkge1xyXG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsIFxyXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycywgXHJcbiAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycywgXHJcbiAgICAgICAgbWV0aG9kOiAnUFVUJyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBkaXNsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycywgXHJcbiAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpOyIsImltcG9ydCAnLi9pbmRleC5jc3MnO1xyXG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgY2FyZFRlbXBsYXRlLFxyXG4gIHByb2ZpbGVGb3JtUG9wdXAsXHJcbiAgY29uZmlnLFxyXG4gIGNhcmRGb3JtUG9wdXAsXHJcbiAgY2FyZHNDb250YWluZXIsXHJcbiAgcHJvZmlsZUZvcm1Qb3B1cFNlbGVjdG9yLFxyXG4gIGNhcmRGb3JtUG9wdXBTZWxlY3RvcixcclxuICBwcm9maWxlTmFtZSxcclxuICBwcm9maWxlRGVzY3JpcHRpb24sXHJcbiAgYXZhdGFyUGljdHVyZSxcclxuICBwb3B1cFR5cGVJbWFnZVNlbGVjdG9yLFxyXG4gIHBvcHVwTmFtZSxcclxuICBwb3B1cERlc2NyaXB0aW9uLFxyXG4gIHBvcHVwRm9yRGVsZXRlQ2FyZCxcclxuICBjaGFuZ2VBdmF0YXJQb3B1cFNlbGVjdG9yXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoU3VibWl0IGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0JztcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcblxyXG4vLyBUb2tlbjogMzhhMjM4NzgtNjRjZS00YWJiLWFlMGQtZDMwZDExY2M5YTM4IEdyb3VwIElEOiBncm91cC0xMlxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjM4YTIzODc4LTY0Y2UtNGFiYi1hZTBkLWQzMGQxMWNjOWEzOFwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICB9XHJcbn0pO1xyXG5cclxubGV0IHVzZXJJZDtcclxuXHJcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UocG9wdXBUeXBlSW1hZ2VTZWxlY3Rvcik7XHJcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBwcm9maWxlRm9ybVBvcHVwKTtcclxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGNhcmRGb3JtUG9wdXApO1xyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBjaGFuZ2VBdmF0YXJQb3B1cFNlbGVjdG9yKTtcclxuXHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmFwaS5nZXRJbml0aWFsQ2FyZHMoKVxyXG4udGhlbihpdGVtcyA9PiB7XHJcbiAgY29uc3QgY2FyZHMgPSBuZXcgU2VjdGlvbih7IGl0ZW1zLCByZW5kZXJlcjogYWRkTmV3Q2FyZCB9LCBjYXJkc0NvbnRhaW5lcik7XHJcbiAgY2FyZHMucmVuZGVyZXIoKTtcclxufSlcclxuXHJcbmFwaS5nZXRVc2VySW5mbygpXHJcbiAgLnRoZW4ocmVzID0+IHtcclxuICAgIGNvbnNvbGUubG9nKFwicHJvZmlsZSBkZXRhaWxlcyBmcm9tIHJlbG9hZCBwYWdlOiBcIiwgcmVzKTtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtuYW1lOiByZXMubmFtZSwgYWJvdXQ6IHJlcy5hYm91dH0pO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMuYXZhdGFyKTtcclxuICAgIHVzZXJJZCA9IHJlcy5faWRcclxuICB9KVxyXG5cclxuXHJcbiAgY29uc3QgcG9wdXBBc2tGb3JEZWxldGUgPSBuZXcgUG9wdXBXaXRoU3VibWl0KHBvcHVwRm9yRGVsZXRlQ2FyZCk7XHJcbiAgcG9wdXBBc2tGb3JEZWxldGUuc2V0RXZlbnRMaXN0ZW5lcnMoKVxyXG5cclxuY29uc3QgYWRkTmV3Q2FyZCA9IChkYXRhKSA9PiB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcclxuICAgIGRhdGEsXHJcbiAgICBoYW5kbGVDYXJkQ2xpY2s6ICgpID0+IHtcclxuICAgICAgaW1hZ2VQb3B1cC5vcGVuKGRhdGEpO1xyXG4gICAgfSxcclxuICAgIGhhbmRsZUxpa2VJY29uOiAoY2FyZElkLCB1c2VySWQsIGxpa2VzQXJyYXkpID0+IHtcclxuICAgICAgaWYgKCFsaWtlc0FycmF5LmZpbmQodXNlciA9PiB1c2VyLl9pZCA9PT0gdXNlcklkICkpIHtcclxuICAgICAgICBhcGkubGlrZUNhcmQoY2FyZElkKVxyXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIGNhcmQubGlrZUNhcmQocmVzLmxpa2VzKVxyXG4gICAgICAgICAgY29uc29sZS5sb2coXCJBZGRlZCBsaWtlIHRvIGNhcmQ6IFwiLCByZXMubGlrZXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYXBpLmRpc2xpa2VDYXJkKGNhcmRJZClcclxuICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICBjYXJkLmRpc2xpa2VDYXJkKHJlcy5saWtlcylcclxuICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVtb3ZlZCBsaWtlIGZyb20gY2FyZDogXCIsIHJlcy5saWtlcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQ6ICgpID0+IHtcclxuICAgICAgcG9wdXBBc2tGb3JEZWxldGUub3BlbigpO1xyXG4gICAgICBwb3B1cEFza0ZvckRlbGV0ZS5zZXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgICAgIGFwaS5kZWxldGVDYXJkKGRhdGEuX2lkKVxyXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNhcmQgaXMgZGVsZXRlZFwiLCByZXMpO1xyXG4gICAgICAgICAgICBjYXJkLnJlbW92ZUNhcmQoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfSwgY2FyZFRlbXBsYXRlLCB1c2VySWQpO1xyXG4gIHJldHVybiBjYXJkLmNyZWF0ZUNhcmQoKTtcclxufTtcclxuXHJcbi8vIFBvcHVwIGZvciBwcm9maWxlIGRldGFpbHMgZm9ybS5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8ocHJvZmlsZU5hbWUsIHByb2ZpbGVEZXNjcmlwdGlvbiwgYXZhdGFyUGljdHVyZSk7XHJcbmNvbnN0IHBvcHVwV2l0aFByb2ZpbGUgPSBuZXcgUG9wdXBXaXRoRm9ybShwcm9maWxlRm9ybVBvcHVwU2VsZWN0b3IsICgpID0+IHtcclxuICBsZXQgcHJvZmlsZURhdGEgPSBwb3B1cFdpdGhQcm9maWxlLmdldElucHV0c1ZhbHVlcygpO1xyXG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHByb2ZpbGVEYXRhKTtcclxuICBhcGkuc2V0VXNlckluZm8ocHJvZmlsZURhdGEpXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgY29uc29sZS5sb2coXCJyZXNcIiwgcmVzKTtcclxuICB9KVxyXG4gIFxyXG4gIHBvcHVwV2l0aFByb2ZpbGUuY2xvc2UoKTtcclxufSk7XHJcblxyXG5cclxuXHJcbnBvcHVwV2l0aFByb2ZpbGUuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IG9wZW5FZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxub3BlbkVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwb3B1cFdpdGhQcm9maWxlLm9wZW4oKTtcclxuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKHByb2ZpbGVOYW1lLCBwcm9maWxlRGVzY3JpcHRpb24pO1xyXG4gIHBvcHVwTmFtZS52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XHJcbiAgcG9wdXBEZXNjcmlwdGlvbi52YWx1ZSA9IHVzZXJEYXRhLmFib3V0O1xyXG4gIGVkaXRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbmNvbnN0IGF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oY2hhbmdlQXZhdGFyUG9wdXBTZWxlY3RvciwgKCkgPT4geyBcclxuICBsZXQgYXZhdGFyVXJsID0gYXZhdGFyUG9wdXAuZ2V0SW5wdXRzVmFsdWVzKCk7XHJcbiAgLy8gdXNlckluZm8uc2V0VXNlckF2YXRhcihhdmF0YXJVcmwubGluayk7XHJcbiAgYXBpLmNoYW5nZUF2YXRhcihhdmF0YXJVcmwpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIocmVzLmF2YXRhcik7XHJcbiAgICB9KTtcclxuICBhdmF0YXJQb3B1cC5jbG9zZSgpXHJcbn0pO1xyXG5hdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3Qgb3BlbkVkaXRBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcclxub3BlbkVkaXRBdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhdmF0YXJQb3B1cC5vcGVuKCk7XHJcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pXHJcblxyXG4vLyBQb3B1cCBmb3IgYWRkIGNhcmQgZm9ybS5cclxuY29uc3QgcG9wdXBXaXRoQWRkQ2FyZCA9IG5ldyBQb3B1cFdpdGhGb3JtKGNhcmRGb3JtUG9wdXBTZWxlY3RvciwgKCkgPT4ge1xyXG4gIGNvbnN0IGRhdGEgPSBwb3B1cFdpdGhBZGRDYXJkLmdldElucHV0c1ZhbHVlcygpXHJcbiAgXHJcbiAgYXBpLmNyZWF0ZUNhcmQoZGF0YSlcclxuICAgIC50aGVuKGl0ZW0gPT4ge1xyXG4gICAgICBjb25zdCBjYXJkcyA9IG5ldyBTZWN0aW9uKHsgaXRlbSwgcmVuZGVyZXI6IGFkZE5ld0NhcmQgfSwgY2FyZHNDb250YWluZXIpO1xyXG4gICAgICBjYXJkcy5hZGRJdGVtKGFkZE5ld0NhcmQoaXRlbSkpO1xyXG4gICAgICBwb3B1cFdpdGhBZGRDYXJkLmNsb3NlKCk7XHJcbiAgICB9KTtcclxufSlcclxuICBcclxucG9wdXBXaXRoQWRkQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3Qgb3BlbkFkZENhcmRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5vcGVuQWRkQ2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwb3B1cFdpdGhBZGRDYXJkLm9wZW4oKTtcclxuICBhZGRDYXJkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xyXG5pbXBvcnQgKiBhcyBjb25zdGFudHMgZnJvbSBcIi4uLy4uL3NyYy91dGlscy9jb25zdGFudHMuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIG9wZW4oY2FyZERhdGEpIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIGNvbnN0YW50cy5wb3B1cEltYWdlLnNyYyA9IGNhcmREYXRhLmxpbms7XHJcbiAgICBjb25zdGFudHMucG9wdXBJbWFnZS5hbHQgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgY29uc3RhbnRzLnBvcHVwSW1hZ2VEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGNhcmREYXRhLm5hbWU7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhTdWJtaXQgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgc2V0QWN0aW9uKGFjdGlvbikge1xyXG4gICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyID0gYWN0aW9uO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyKCk7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aFN1Ym1pdDsiLCJpbXBvcnQgeyBwcm9maWxlTmFtZSwgcHJvZmlsZURlc2NyaXB0aW9uIH0gZnJvbSBcIi4uLy4uL3NyYy91dGlscy9jb25zdGFudHMuanNcIjtcclxuXHJcbmNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3RvcihuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fbmFtZSA9IG5hbWVTZWxlY3RvcjtcclxuICAgIHRoaXMuX2pvYiA9IGpvYlNlbGVjdG9yO1xyXG4gICAgdGhpcy5fYXZhdGFyID0gYXZhdGFyU2VsZWN0b3I7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWMgbWV0aG9kIHdoaWNoIHJldHVybnMgYW4gb2JqZWN0IHdpdGggaW5mb3JtYXRpb24gYWJvdXQgdGhlIHVzZXIuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4geyBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LCBhYm91dDogdGhpcy5fam9iLnRleHRDb250ZW50IH07XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWMgbWV0aG9kIHdoaWNoIHRha2VzIG5ldyB1c2VyIGRhdGEgYW5kIGFkZHMgaXQgb24gdGhlIHBhZ2UuXHJcbiAgc2V0VXNlckluZm8obmV3RGF0YSkge1xyXG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IG5ld0RhdGEubmFtZTtcclxuICAgIHRoaXMuX2pvYi50ZXh0Q29udGVudCA9IG5ld0RhdGEuYWJvdXQ7XHJcbiAgfVxyXG4gIC8vIFB1YmxpYyBtZXRob2Qgd2hpY2ggaW5wdXQgdGhlIG5ldyBhdmF0YXIgdG8gdGhlIHBhZ2UuXHJcbiAgc2V0VXNlckF2YXRhcihuZXdBdmF0YXIpIHtcclxuICAgIHRoaXMuX2F2YXRhci5zdHlsZSA9IGBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJHtuZXdBdmF0YXJ9KTtgXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBVc2VySW5mbztcclxuIl0sIm5hbWVzIjpbIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX3NldHRpbmdzIiwiX2Zvcm1FbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX3Nob3dFcnJvck1lc3NhZ2UiLCJpbnB1dCIsImVycm9yTWVzc2FnZSIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZXJyb3JFbGVtZW50IiwiaWQiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsImFkZCIsIl9oaWRlRXJyb3JNZXNzYWdlIiwicmVtb3ZlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9pbnB1dHNMaXN0IiwiaW5wdXRTZWxlY3RvciIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc2VsZWN0QnV0dG9uIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiYnV0dG9uIiwic29tZSIsImlucHV0RWxlbWVudCIsInNldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsIl9zZXRFdmVudExpc3RlbmVycyIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInJlc2V0VmFsaWRhdGlvbiIsIml0ZW1zIiwicmVuZGVyZXIiLCJjb250YWluZXJTZWxlY3RvciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJkYXRhIiwiY2FyZCIsImFkZEl0ZW0iLCJjYXJkRWxlbWVudCIsInByZXBlbmQiLCJjYXJkVGVtcGxhdGUiLCJjb250ZW50IiwiY2FyZHNDb250YWluZXIiLCJjb25maWciLCJjaGFuZ2VBdmF0YXJQb3B1cFNlbGVjdG9yIiwicHJvZmlsZU5hbWUiLCJhdmF0YXJQaWN0dXJlIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicG9wdXBOYW1lIiwicG9wdXBEZXNjcmlwdGlvbiIsInBvcHVwSW1hZ2UiLCJwb3B1cEltYWdlRGVzY3JpcHRpb24iLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIl9oYW5kbGVDbG9zZVBvcHVwd1dpdGhPdmVybGF5IiwiZXZlbnQiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJvcGVuIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwIiwic3VibWl0SGFuZGxlciIsInN1cGVyIiwiX3N1Ym1pdEhhbmRsZXIiLCJfZm9ybSIsImdldElucHV0c1ZhbHVlcyIsImlucHV0cyIsImlucHV0c1ZhbHVlcyIsIm5hbWUiLCJ2YWx1ZSIsInByZXZlbnREZWZhdWx0IiwicmVzZXQiLCJjdXN0b21GZXRjaCIsInVybCIsImhlYWRlcnMiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzVGV4dCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImFwaSIsImJhc2VVcmwiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0SW5pdGlhbENhcmRzIiwibWV0aG9kIiwiZ2V0VXNlckluZm8iLCJjaGFuZ2VBdmF0YXIiLCJuZXdBdmF0YXIiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInNldFVzZXJJbmZvIiwiY3JlYXRlQ2FyZCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsImRpc2xpa2VDYXJkIiwiYXV0aG9yaXphdGlvbiIsInVzZXJJZCIsImltYWdlUG9wdXAiLCJjYXJkRGF0YSIsImNvbnN0YW50cyIsImxpbmsiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImFkZENhcmRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsIlNlY3Rpb24iLCJhZGROZXdDYXJkIiwidXNlckluZm8iLCJhYm91dCIsInNldFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJfaWQiLCJwb3B1cEFza0ZvckRlbGV0ZSIsInNldEFjdGlvbiIsImFjdGlvbiIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVMaWtlSWNvbiIsIl90ZW1wbGF0ZSIsIl9uYW1lIiwiX2xpbmsiLCJfb3duZXJJZCIsIm93bmVyIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVMaWtlSWNvbiIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX3VzZXJJZCIsIl9saWtlcyIsImxpa2VzIiwiX2NhcmRJZCIsIl9jYXJkIiwic3R5bGUiLCJkaXNwbGF5IiwicmVtb3ZlQ2FyZCIsIm5ld0xpa2VzIiwibGVuZ3RoIiwiY2xvbmVOb2RlIiwiaW1nIiwicGVyc29uIiwibGlrZXNBcnJheSIsImZpbmQiLCJ1c2VyIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9qb2IiLCJfYXZhdGFyIiwibmV3RGF0YSIsInBvcHVwV2l0aFByb2ZpbGUiLCJQb3B1cFdpdGhGb3JtIiwicHJvZmlsZURhdGEiLCJ1c2VyRGF0YSIsImF2YXRhclBvcHVwIiwiYXZhdGFyVXJsIiwicG9wdXBXaXRoQWRkQ2FyZCIsIml0ZW0iXSwic291cmNlUm9vdCI6IiJ9