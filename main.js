!function(){"use strict";class e{constructor(e,t){this._settings=e,this._formElement=document.querySelector(`${t}`)}_showErrorMessage(e,t){const{inputErrorClass:s,errorClass:r}=this._settings;this._errorElement=this._formElement.querySelector(`.${e.id}-error`),this._errorElement.textContent=t,this._errorElement.classList.add(s),e.classList.add(r)}_hideErrorMessage(e){const{inputErrorClass:t,errorClass:s}=this._settings;this._errorElement=this._formElement.querySelector(`.${e.id}-error`),this._errorElement.textContent="",this._errorElement.classList.remove(t),e.classList.remove(s)}_checkInputValidity(e){if(e.validity.valid)this._hideErrorMessage(e);else{const t=e.validationMessage;this._showErrorMessage(e,t)}}_inputsList(){const{inputSelector:e}=this._settings;return Array.from(this._formElement.querySelectorAll(e))}_selectButton(){const{submitButtonSelector:e}=this._settings;return this._formElement.querySelector(e)}_toggleButtonState(){const{inactiveButtonClass:e}=this._settings,t=this._selectButton();this._inputsList().some((e=>!e.validity.valid))?(t.classList.add(e),t.setAttribute("disabled",!0)):(t.classList.remove(e),t.removeAttribute("disabled"))}_setEventListeners(){this._inputsList().forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{})),this._setEventListeners()}resetValidation(){const{inactiveButtonClass:e}=this._settings,t=this._selectButton();t.classList.add(e),t.setAttribute("disabled","true"),this._inputsList().forEach((e=>{this._hideErrorMessage(e)}))}}var t=class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}renderer(){this._items.forEach((e=>{const t=this._renderer(e);this.addItem(t)}))}addItem(e){this._container.prepend(e)}};const s=document.querySelector("#card-template").content,r=".cards__container",n={inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disable",inputErrorClass:"popup__input_type_error",errorClass:"popup__input_error-visible"},i=document.querySelector(".profile__name"),o=document.querySelector(".profile__description"),a=document.querySelector(".popup__input_content_name"),l=document.querySelector(".popup__input_content_description"),d=document.querySelector(".popup__image"),c=document.querySelector(".popup__image-description");var _=class{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this._handleClosePopupwWithOverlay=this._handleClosePopupwWithOverlay.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleClosePopupwWithOverlay(e){e.target.classList.contains("popup_open")&&this.close()}setEventListeners(){this._popup.querySelector(".popup__close-button").addEventListener("click",(()=>{this.close()}))}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._handleClosePopupwWithOverlay)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("mousedown",this._handleClosePopupwWithOverlay)}},h=class extends _{constructor(e,t){super(e),this._submitHandler=t,this._form=this._popup.querySelector(".popup__form")}getInputsValues(){const e=Array.from(this._form.querySelectorAll(".popup__input")),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler()}))}close(){super.close(),this._form.reset()}};const u=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject(e.statusText))).catch((e=>console.log(e))),p=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}getInitialCards(){return u(`${this._baseUrl}/cards`,{headers:this._headers,method:"GET"})}getUserInfo(){return u(`${this._baseUrl}/users/me`,{headers:this._headers})}createCard(e){return u(`${this._baseUrl}/cards`,{headers:this._headers,method:"POST",body:JSON.stringify(e)})}deleteCard(e){return u(`${this._baseUrl}/cards/${e}`,{headers:this._headers,method:"DELETE"})}likeCard(e){return u(`${this._baseUrl}/cards/likes/${e}`,{headers:this._headers,method:"PUT"})}dislikeCard(e){return u(`${this._baseUrl}/cards/likes/${e}`,{headers:this._headers,method:"DELETE"})}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"38a23878-64ce-4abb-ae0d-d30d11cc9a38","Content-Type":"application/json"}});let m;const E=new class extends _{open(e){super.open(),d.src=e.link,d.alt=e.name,c.textContent=e.name}}(".popup_type_image");E.setEventListeners();const v=new e(n,".popup__form_profile"),b=new e(n,".popup__form_add-card");v.enableValidation(),b.enableValidation(),p.getInitialCards().then((e=>{new t({items:e,renderer:y},r).renderer()})),p.getUserInfo().then((e=>{L.setUserInfo({name:e.name,about:e.about}),m=e._id}));const C=new class extends _{setAction(e){this._submitHandler=e}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler(),this.close()}))}}(".popup_type_delete-card");C.setEventListeners();const y=e=>{const t=new class{constructor({data:e,handleCardClick:t,handleDeleteCard:s,handleLikeIcon:r},n,i){this._template=n,this._name=e.name,this._link=e.link,this._ownerId=e.owner._id,this._handleCardClick=t,this._handleLikeIcon=r,this._handleDeleteCard=s,this._userId=i,this._likes=e.likes}_setEventListeners(){this._card.querySelector(".cards__like-button").addEventListener("click",(()=>this._handleLikeIcon(this._userId))),this._card.querySelector(".cards__delete-button").addEventListener("click",(()=>this._handleDeleteCard(this._userId))),this._ownerId!==this._userId&&(this._card.querySelector(".cards__delete-button").style.display="none");const e={name:this._name,link:this._link};this._card.querySelector(".cards__image").addEventListener("click",(()=>{this._handleCardClick(e)}))}removeCard(){this._card.remove(),this._card=null}createCard(){const e=this._template.querySelector(".cards__card").cloneNode(!0),t=e.querySelector(".cards__image");return t.setAttribute("src",this._link),t.setAttribute("alt",this._name),e.querySelector(".cards__header").textContent=this._name,this._card=e,this._card.querySelector(".cards__likes-counter").textContent=this._likes.length,this._setEventListeners(),this._card}}({data:e,handleCardClick:()=>{E.open(e)},handleLikeIcon:e=>{p.likeCard(e).then((e=>{console.log("res",e)}))},handleDeleteCard:()=>{C.open(),C.setEventListeners(),C.setAction((()=>{p.deleteCard(e._id).then((e=>{console.log("card is deleted",e),t.removeCard()}))}))}},s,m);return t.createCard()},L=new class{constructor(e,t){this._name=e,this._job=t}getUserInfo(){return{name:this._name.textContent,about:this._job.textContent}}setUserInfo(e){this._name.textContent=e.name,this._job.textContent=e.about}}(i,o),f=new h(".popup_type_edit-profile",(()=>{L.setUserInfo(f.getInputsValues()),f.close()}));f.setEventListeners(),document.querySelector(".profile__edit-button").addEventListener("click",(()=>{f.open();const e=L.getUserInfo(i,o);a.value=e.name,l.value=e.about,v.resetValidation()}));const g=new h(".popup_type_add-card",(()=>{const e=g.getInputsValues();p.createCard(e).then((e=>{new t({item:e,renderer:y},r).addItem(y(e)),g.close()}))}));g.setEventListeners(),document.querySelector(".profile__add-button").addEventListener("click",(()=>{g.open(),b.resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBQ3BETCxRQUFRNkUsRUFBV3FDLElBQ3pCRCxFQUFpQjdGLGNBSXZCNkYsRUFBaUIxRixvQkFFT3JFLFNBQVNDLGNBQWMsd0JBQy9CaUMsaUJBQWlCLFNBQVMsS0FDeEM2SCxFQUFpQnpGLE9BQ2pCbUQsRUFBcUJwRixxQiIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQtbWFpbi8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC1tYWluLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LW1haW4vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQtbWFpbi8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC1tYWluLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC1tYWluLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LW1haW4vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC1tYWluLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQtbWFpbi8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQtbWFpbi8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LW1haW4vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTcHJpbnQgNyAtIHByb2plY3QgTGl2ZSBDb2RpbmcsIExpemEgLSB0aW1lIG9uIHZpZGVvOiAwOjAwIC0gNDA6MDAgbWlucy5cblxuY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAke2Zvcm1FbGVtZW50fWApO1xuICB9XG5cbiAgX3Nob3dFcnJvck1lc3NhZ2UoaW5wdXQsIGVycm9yTWVzc2FnZSkge1xuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5wdXRFcnJvckNsYXNzKTtcbiAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKGVycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVFcnJvck1lc3NhZ2UoaW5wdXQpIHtcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JDbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXQuaWR9LWVycm9yYCk7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShpbnB1dEVycm9yQ2xhc3MpO1xuICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KSB7XG4gICAgaWYgKCFpbnB1dC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gaW5wdXQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgICB0aGlzLl9zaG93RXJyb3JNZXNzYWdlKGlucHV0LCBlcnJvck1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlRXJyb3JNZXNzYWdlKGlucHV0KTtcbiAgICB9XG4gIH1cblxuICBfaW5wdXRzTGlzdCgpIHtcbiAgICBjb25zdCB7IGlucHV0U2VsZWN0b3IgfSA9IHRoaXMuX3NldHRpbmdzO1xuICAgIGNvbnN0IGlucHV0c0xpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChpbnB1dFNlbGVjdG9yKVxuICAgICk7XG4gICAgcmV0dXJuIGlucHV0c0xpc3Q7XG4gIH1cblxuICBfc2VsZWN0QnV0dG9uKCkge1xuICAgIGNvbnN0IHsgc3VibWl0QnV0dG9uU2VsZWN0b3IgfSA9IHRoaXMuX3NldHRpbmdzO1xuICAgIGNvbnN0IGJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICAgIHJldHVybiBidXR0b247XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgY29uc3QgeyBpbmFjdGl2ZUJ1dHRvbkNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcbiAgICBjb25zdCBidXR0b24gPSB0aGlzLl9zZWxlY3RCdXR0b24oKTtcbiAgICBjb25zdCBpbnB1dExpc3QgPSB0aGlzLl9pbnB1dHNMaXN0KCk7XG4gICAgY29uc3QgaXNGb3JtSW52YWxpZCA9IGlucHV0TGlzdC5zb21lKFxuICAgICAgKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxuICAgICk7XG4gICAgaWYgKCFpc0Zvcm1JbnZhbGlkKSB7XG4gICAgICBidXR0b24uY2xhc3NMaXN0LnJlbW92ZShpbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIGJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICBidXR0b24uc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIGNvbnN0IGlucHV0c0xpc3QgPSB0aGlzLl9pbnB1dHNMaXN0KCk7XG4gICAgaW5wdXRzTGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHt9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIGNvbnN0IHsgaW5hY3RpdmVCdXR0b25DbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XG4gICAgY29uc3QgYnV0dG9uID0gdGhpcy5fc2VsZWN0QnV0dG9uKCk7XG4gICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgYnV0dG9uLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwidHJ1ZVwiKTtcbiAgICBjb25zdCBpbnB1dHNMaXN0ID0gdGhpcy5faW5wdXRzTGlzdCgpO1xuICAgIGlucHV0c0xpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlRXJyb3JNZXNzYWdlKGlucHV0RWxlbWVudCk7XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IHsgRm9ybVZhbGlkYXRvciB9O1xuIiwiY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgLy8gUHVibGljIG1ldGhvZCB0aGF0IHJlbmRlcnMgYWxsIGVsZW1lbnRzIG9uIHRoZSBwYWdlLlxuICByZW5kZXJlcigpIHtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChkYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkID0gdGhpcy5fcmVuZGVyZXIoZGF0YSk7XG4gICAgICB0aGlzLmFkZEl0ZW0oY2FyZCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBQdWJsaWMgbWV0aG9kIHRoYXQgdGFrZXMgYSBET00gZWxlbWVudCBhbmQgYWRkcyBpdCB0byB0aGUgY29udGFpbmVyLlxuICBhZGRJdGVtKGNhcmRFbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNlY3Rpb247XG4iLCIvLyBpbXBvcnQgaGF2YW5hIGZyb20gJy4uL2ltYWdlcy9oYXZhbmEuanBnJztcbi8vIGltcG9ydCB2aW5hbGVzIGZyb20gJy4uL2ltYWdlcy92aW5hbGVzLmpwZyc7XG4vLyBpbXBvcnQgcGVsaWNhbiBmcm9tICcuLi9pbWFnZXMvcGVsaWNhbi5qcGcnXG4vLyBpbXBvcnQgYXJkZWFIZXJvZGlhcyBmcm9tICcuLi9pbWFnZXMvYXJkZWEtaGVyb2RpYXMuanBnJztcbi8vIGltcG9ydCB2aWV3RnJvbU1hbmFyYSBmcm9tICcuLi9pbWFnZXMvdmlldy1mcm9tLW1hbmFyYS5qcGcnO1xuLy8gaW1wb3J0IGJpcml5YUZvcmVzdCBmcm9tICcuLi9pbWFnZXMvYmlyaXlhLWZvcmVzdC5qcGcnO1xuXG4vLyBJbml0aWFsaXphdGlvbiBjYXJkcyBvbiBsb2FkaW5nIHBhZ2UuXG4vLyBleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuLy8gICB7XG4vLyAgICAgbmFtZTogXCJPbGRpZXMgY2FycyBpbiBIYXZhbmEsIEN1YmEuXCIsXG4vLyAgICAgbGluazogaGF2YW5hXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIlRvYmFjY28gZmllbGQgaW4gVmnDsWFsZXMgdmFsbGV5LCBDdWJhLlwiLFxuLy8gICAgIGxpbms6IHZpbmFsZXNcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiUGVsaWNhbiBpbiBhIGxha2UsIFNhcmFzb3RhIEZMLCBVU0EuXCIsXG4vLyAgICAgbGluazogcGVsaWNhblxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJHcmVhdCBibHVlIGhlcm9uLCBTYXJhc290YSBGTCwgVVNBLlwiLFxuLy8gICAgIGxpbms6IGFyZGVhSGVyb2RpYXNcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiU2lnaHQgZnJvbSBNYW5hcmEgdG8gc291dGhlcm4gTGViYW5vbiBpbiB3aW50ZXIgLCBJc3JhZWwuXCIsXG4vLyAgICAgbGluazogdmlld0Zyb21NYW5hcmFcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiQmlyaXlhIGZvcmVzdCwgWmVmYXQsIElzcmFlbFwiLFxuLy8gICAgIGxpbms6IGJpcml5YUZvcmVzdFxuLy8gICB9XG4vLyBdO1xuXG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQ7XG5leHBvcnQgY29uc3QgY2FyZHNDb250YWluZXIgPSBcIi5jYXJkc19fY29udGFpbmVyXCI7XG5cbi8vIEZvcm0gVmFsaWRhdGlvbiBjbGFzc2VzLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fc3VibWl0LWJ1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X2Vycm9yLXZpc2libGVcIixcbn07XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlRm9ybVBvcHVwID0gXCIucG9wdXBfX2Zvcm1fcHJvZmlsZVwiO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVGb3JtUG9wdXBTZWxlY3RvciA9IFwiLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlXCI7XG5leHBvcnQgY29uc3QgY2FyZEZvcm1Qb3B1cCA9IFwiLnBvcHVwX19mb3JtX2FkZC1jYXJkXCI7XG5leHBvcnQgY29uc3QgY2FyZEZvcm1Qb3B1cFNlbGVjdG9yID0gXCIucG9wdXBfdHlwZV9hZGQtY2FyZFwiO1xuZXhwb3J0IGNvbnN0IHBvcHVwRm9yRGVsZXRlQ2FyZCA9IFwiLnBvcHVwX3R5cGVfZGVsZXRlLWNhcmRcIjtcbmV4cG9ydCBjb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiXG4pO1xuZXhwb3J0IGNvbnN0IHBvcHVwTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0X2NvbnRlbnRfbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBwb3B1cERlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucG9wdXBfX2lucHV0X2NvbnRlbnRfZGVzY3JpcHRpb25cIlxuKTtcblxuLy8gSW1hZ2UgcG9wdXAuXG5leHBvcnQgY29uc3QgcG9wdXBUeXBlSW1hZ2VTZWxlY3RvciA9IFwiLnBvcHVwX3R5cGVfaW1hZ2VcIjtcbi8vIGV4cG9ydCBjb25zdCBwb3B1cFR5cGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9pbWFnZVwiKTtcbmV4cG9ydCBjb25zdCBwb3B1cEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XG5leHBvcnQgY29uc3QgcG9wdXBJbWFnZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucG9wdXBfX2ltYWdlLWRlc2NyaXB0aW9uXCJcbik7XG4iLCJjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3Ioe2RhdGEsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlRGVsZXRlQ2FyZCwgaGFuZGxlTGlrZUljb259LCBjYXJkVGVtcGxhdGUsIHVzZXJJZCkge1xuICAgIHRoaXMuX3RlbXBsYXRlID0gY2FyZFRlbXBsYXRlO1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VJY29uID0gaGFuZGxlTGlrZUljb247XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBMaWtlIGJ1dHRvbnMuXG4gICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saWtlLWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlSWNvbih0aGlzLl91c2VySWQpKTtcbiAgICAgIC8vIHtcbiAgICAgICAgLy8gbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZHNfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICAgIC8vIH0pO1xuXG4gICAgLy8gRGVsZXRlIGJ1dHRvbnMuXG4gICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19kZWxldGUtYnV0dG9uXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+ICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKHRoaXMuX3VzZXJJZCkpO1xuICAgIGlmKHRoaXMuX293bmVySWQgIT09IHRoaXMuX3VzZXJJZCkge1xuICAgICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19kZWxldGUtYnV0dG9uXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICB9XG5cbiAgICAvLyBTaG93IGltYWdlIGFzIHBvcHVwLlxuICAgIGNvbnN0IGNhcmREYXRhID0geyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH07XG4gICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19pbWFnZVwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayhjYXJkRGF0YSk7XG4gICAgICB9KTtcbiAgfVxuICAgIFxuICByZW1vdmVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmQucmVtb3ZlKCk7XG4gICAgdGhpcy5fY2FyZCA9IG51bGw7XG4gIH1cblxuICBjcmVhdGVDYXJkKCkge1xuICAgIGNvbnN0IGNhcmQgPSB0aGlzLl90ZW1wbGF0ZVxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2NhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgY29uc3QgaW1nID0gY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19pbWFnZVwiKTtcbiAgICBpbWcuc2V0QXR0cmlidXRlKFwic3JjXCIsIHRoaXMuX2xpbmspO1xuICAgIGltZy5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgdGhpcy5fbmFtZSk7XG5cbiAgICBjb25zdCBjYXJkVGl0bGUgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2hlYWRlclwiKTtcbiAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgdGhpcy5fY2FyZCA9IGNhcmQ7XG4gICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saWtlcy1jb3VudGVyXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoIFxuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICByZXR1cm4gdGhpcy5fY2FyZDtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xuIiwiY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9oYW5kbGVDbG9zZVBvcHVwd1dpdGhPdmVybGF5ID1cbiAgICAgIHRoaXMuX2hhbmRsZUNsb3NlUG9wdXB3V2l0aE92ZXJsYXkuYmluZCh0aGlzKTtcbiAgfVxuXG4gIC8vIFByaXZhdGUgbWV0aG9kIHRoYXQgY2xvc2UgcG9wdXAgd2luZG93IGJ5IEVzY2FwZSBrZXkuXG4gIF9oYW5kbGVFc2NDbG9zZShldmVudCkge1xuICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICAvLyBQcml2YXRlIG1ldGhvZCB0aGF0IGNsb3NlIHBvcHVwIHdpbmRvdyBieSBjbGlja2luZyBvbiB0aGUgb3ZlcmxheS5cbiAgX2hhbmRsZUNsb3NlUG9wdXB3V2l0aE92ZXJsYXkoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX29wZW5cIikpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICAvLyBQdWJsaWMgbWV0aG9kIHRoYXQgYWRkcyBhbiBldmVudCBsaXN0ZW5lciB0byB0aGUgY2xvc2UgaWNvbiBvZiB0aGUgcG9wdXAuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIGNvbnN0IGNsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2UtYnV0dG9uXCIpO1xuXG4gICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIFB1YmxpYyBtZXRob2QgdGhhdCBvcGVuIHRoZSBwb3B1cCB3aW5kb3cuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5cIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlQ2xvc2VQb3B1cHdXaXRoT3ZlcmxheSk7XG4gIH1cblxuICAvLyBQdWJsaWMgbWV0aG9kIHRoYXQgY2xvc2UgdGhlIHBvcHVwIHdpbmRvdy5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5cIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlQ2xvc2VQb3B1cHdXaXRoT3ZlcmxheSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXA7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcblxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgc3VibWl0SGFuZGxlcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpOyAvLyB0aGlzLl9wb3B1cFxuICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIgPSBzdWJtaXRIYW5kbGVyO1xuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xuICB9XG5cbiAgLy8gUHJpdmF0ZSBtZXRob2Qgd2hpY2ggY29sbGVjdCBkYXRhIGZyb20gYWxsIHRoZSBpbnB1dCBmaWVsZHMuXG4gIGdldElucHV0c1ZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dHMgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIikpO1xuICAgIGNvbnN0IGlucHV0c1ZhbHVlcyA9IHt9O1xuICAgIGlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRzVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGlucHV0c1ZhbHVlcztcbiAgfVxuXG4gIC8vIE1vZGlmaWVzIHRoZSBwYXJlbnQgbWV0aG9kIGFuZCBhZGQgZXZlbnQgbGlzdGVuZXIgdG8gY2xvc2UgaWNvbiBhbmQgc3VibWl0IGJ1dHRvbi5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyKCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBNb2RpZmllcyB0aGUgcGFyZW50IG1ldGhvZCBpbiBvcmRlciB0byByZXNldCB0aGUgZm9ybSBvbmNlIHRoZSBwb3B1cCBpcyBjbG9zZWQuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07XG4iLCJjb25zdCBjdXN0b21GZXRjaCA9ICh1cmwsIGhlYWRlcnMpID0+XHJcbiAgZmV0Y2godXJsLCBoZWFkZXJzKVxyXG4gICAgLnRoZW4ocmVzID0+IHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzVGV4dCkpXHJcbiAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpXHJcblxyXG5jbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3Ioe2Jhc2VVcmwsIGhlYWRlcnN9KSB7XHJcbiAgICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICAgIH1cclxuXHJcbiAgLy8gb3RoZXIgbWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIHRoZSBBUElcclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgbWV0aG9kOiAnR0VUJyAvLyBkZWZhdWx0IG9wdGlvblxyXG4gICAgfSlcclxuICB9XHJcbiAgXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGNyZWF0ZUNhcmQoZGF0YSkge1xyXG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsIFxyXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycywgXHJcbiAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycywgXHJcbiAgICAgICAgbWV0aG9kOiAnUFVUJyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBkaXNsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycywgXHJcbiAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpOyIsImltcG9ydCAnLi9pbmRleC5jc3MnO1xuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCB7XG4gIGNhcmRUZW1wbGF0ZSxcbiAgcHJvZmlsZUZvcm1Qb3B1cCxcbiAgY29uZmlnLFxuICBjYXJkRm9ybVBvcHVwLFxuICBjYXJkc0NvbnRhaW5lcixcbiAgaW5pdGlhbENhcmRzLFxuICBwcm9maWxlRm9ybVBvcHVwU2VsZWN0b3IsXG4gIGNhcmRGb3JtUG9wdXBTZWxlY3RvcixcbiAgcHJvZmlsZU5hbWUsXG4gIHByb2ZpbGVEZXNjcmlwdGlvbixcbiAgcG9wdXBUeXBlSW1hZ2VTZWxlY3RvcixcbiAgcG9wdXBOYW1lLFxuICBwb3B1cERlc2NyaXB0aW9uLFxuICBwb3B1cEZvckRlbGV0ZUNhcmRcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoU3VibWl0IGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0JztcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuXG4vLyBUb2tlbjogMzhhMjM4NzgtNjRjZS00YWJiLWFlMGQtZDMwZDExY2M5YTM4IEdyb3VwIElEOiBncm91cC0xMlxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCIzOGEyMzg3OC02NGNlLTRhYmItYWUwZC1kMzBkMTFjYzlhMzhcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICB9XG59KTtcblxubGV0IHVzZXJJZDtcblxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShwb3B1cFR5cGVJbWFnZVNlbGVjdG9yKTtcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVGb3JtUG9wdXApO1xuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGNhcmRGb3JtUG9wdXApO1xuXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hZGRDYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmFwaS5nZXRJbml0aWFsQ2FyZHMoKVxuLnRoZW4oaXRlbXMgPT4ge1xuICBjb25zdCBjYXJkcyA9IG5ldyBTZWN0aW9uKHsgaXRlbXMsIHJlbmRlcmVyOiBhZGROZXdDYXJkIH0sIGNhcmRzQ29udGFpbmVyKTtcbiAgY2FyZHMucmVuZGVyZXIoKTtcbn0pXG5cbmFwaS5nZXRVc2VySW5mbygpXG4gIC50aGVuKHJlcyA9PiB7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe25hbWU6IHJlcy5uYW1lLCBhYm91dDogcmVzLmFib3V0fSlcbiAgICB1c2VySWQgPSByZXMuX2lkXG4gIH0pXG5cblxuICBjb25zdCBwb3B1cEFza0ZvckRlbGV0ZSA9IG5ldyBQb3B1cFdpdGhTdWJtaXQocG9wdXBGb3JEZWxldGVDYXJkKTtcbiAgcG9wdXBBc2tGb3JEZWxldGUuc2V0RXZlbnRMaXN0ZW5lcnMoKVxuXG5jb25zdCBhZGROZXdDYXJkID0gKGRhdGEpID0+IHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcbiAgICBkYXRhLFxuICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xuICAgICAgaW1hZ2VQb3B1cC5vcGVuKGRhdGEpO1xuICAgIH0sXG4gICAgaGFuZGxlTGlrZUljb246IChpZCkgPT4ge1xuICAgICAgYXBpLmxpa2VDYXJkKGlkKVxuICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJyZXNcIiwgcmVzKTtcbiAgICAgICAgfSlcbiAgICB9LFxuICAgIGhhbmRsZURlbGV0ZUNhcmQ6ICgpID0+IHtcbiAgICAgIHBvcHVwQXNrRm9yRGVsZXRlLm9wZW4oKTtcbiAgICAgIHBvcHVwQXNrRm9yRGVsZXRlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICBwb3B1cEFza0ZvckRlbGV0ZS5zZXRBY3Rpb24oKCkgPT4ge1xuICAgICAgICBhcGkuZGVsZXRlQ2FyZChkYXRhLl9pZClcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNhcmQgaXMgZGVsZXRlZFwiLCByZXMpO1xuICAgICAgICAgICAgY2FyZC5yZW1vdmVDYXJkKCk7XG4gICAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgfVxuICB9LCBjYXJkVGVtcGxhdGUsIHVzZXJJZCk7XG4gIHJldHVybiBjYXJkLmNyZWF0ZUNhcmQoKTtcbn07XG5cbi8vIFBvcHVwIGZvciBwcm9maWxlIGRldGFpbHMgZm9ybS5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHByb2ZpbGVOYW1lLCBwcm9maWxlRGVzY3JpcHRpb24pO1xuY29uc3QgcG9wdXBXaXRoUHJvZmlsZSA9IG5ldyBQb3B1cFdpdGhGb3JtKHByb2ZpbGVGb3JtUG9wdXBTZWxlY3RvciwgKCkgPT4ge1xuICB1c2VySW5mby5zZXRVc2VySW5mbyhwb3B1cFdpdGhQcm9maWxlLmdldElucHV0c1ZhbHVlcygpKTtcbiAgcG9wdXBXaXRoUHJvZmlsZS5jbG9zZSgpO1xufSk7XG5wb3B1cFdpdGhQcm9maWxlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cblxuXG5jb25zdCBvcGVuRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5vcGVuRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBwb3B1cFdpdGhQcm9maWxlLm9wZW4oKTtcbiAgY29uc3QgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbyhwcm9maWxlTmFtZSwgcHJvZmlsZURlc2NyaXB0aW9uKTtcbiAgcG9wdXBOYW1lLnZhbHVlID0gdXNlckRhdGEubmFtZTtcbiAgcG9wdXBEZXNjcmlwdGlvbi52YWx1ZSA9IHVzZXJEYXRhLmFib3V0O1xuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbn0pO1xuXG4vLyBQb3B1cCBmb3IgYWRkIGNhcmQgZm9ybS5cbmNvbnN0IHBvcHVwV2l0aEFkZENhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybShjYXJkRm9ybVBvcHVwU2VsZWN0b3IsICgpID0+IHtcbiAgY29uc3QgZGF0YSA9IHBvcHVwV2l0aEFkZENhcmQuZ2V0SW5wdXRzVmFsdWVzKClcbiAgXG4gIGFwaS5jcmVhdGVDYXJkKGRhdGEpXG4gICAgLnRoZW4oaXRlbSA9PiB7XG4gICAgICBjb25zdCBjYXJkcyA9IG5ldyBTZWN0aW9uKHsgaXRlbSwgcmVuZGVyZXI6IGFkZE5ld0NhcmQgfSwgY2FyZHNDb250YWluZXIpO1xuICAgICAgY2FyZHMuYWRkSXRlbShhZGROZXdDYXJkKGl0ZW0pKTtcbiAgICAgIHBvcHVwV2l0aEFkZENhcmQuY2xvc2UoKTtcbiAgICB9KTtcbn0pXG4gIFxucG9wdXBXaXRoQWRkQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBvcGVuQWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5vcGVuQWRkQ2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcG9wdXBXaXRoQWRkQ2FyZC5vcGVuKCk7XG4gIGFkZENhcmRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcbmltcG9ydCAqIGFzIGNvbnN0YW50cyBmcm9tIFwiLi4vLi4vc3JjL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgb3BlbihjYXJkRGF0YSkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICBjb25zdGFudHMucG9wdXBJbWFnZS5zcmMgPSBjYXJkRGF0YS5saW5rO1xuICAgIGNvbnN0YW50cy5wb3B1cEltYWdlLmFsdCA9IGNhcmREYXRhLm5hbWU7XG4gICAgY29uc3RhbnRzLnBvcHVwSW1hZ2VEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGNhcmREYXRhLm5hbWU7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoSW1hZ2U7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aFN1Ym1pdCBleHRlbmRzIFBvcHVwIHtcclxuICBzZXRBY3Rpb24oYWN0aW9uKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIgPSBhY3Rpb247XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5fc3VibWl0SGFuZGxlcigpO1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhTdWJtaXQ7IiwiaW1wb3J0IHsgcHJvZmlsZU5hbWUsIHByb2ZpbGVEZXNjcmlwdGlvbiB9IGZyb20gXCIuLi8uLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbmNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBqb2JTZWxlY3Rvcikge1xuICAgIHRoaXMuX25hbWUgPSBuYW1lU2VsZWN0b3I7XG4gICAgdGhpcy5fam9iID0gam9iU2VsZWN0b3I7XG4gIH1cblxuICAvLyBQdWJsaWMgbWV0aG9kIHdoaWNoIHJldHVybnMgYW4gb2JqZWN0IHdpdGggaW5mb3JtYXRpb24gYWJvdXQgdGhlIHVzZXIuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7IG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsIGFib3V0OiB0aGlzLl9qb2IudGV4dENvbnRlbnQgfTtcbiAgfVxuXG4gIC8vIFB1YmxpYyBtZXRob2Qgd2hpY2ggdGFrZXMgbmV3IHVzZXIgZGF0YSBhbmQgYWRkcyBpdCBvbiB0aGUgcGFnZS5cbiAgc2V0VXNlckluZm8obmV3Q2FyZERhdGEpIHtcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmV3Q2FyZERhdGEubmFtZTtcbiAgICB0aGlzLl9qb2IudGV4dENvbnRlbnQgPSBuZXdDYXJkRGF0YS5hYm91dDtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBVc2VySW5mbztcbiJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9zZXR0aW5ncyIsIl9mb3JtRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIl9zaG93RXJyb3JNZXNzYWdlIiwiaW5wdXQiLCJlcnJvck1lc3NhZ2UiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Vycm9yRWxlbWVudCIsImlkIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJfaGlkZUVycm9yTWVzc2FnZSIsInJlbW92ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaW5wdXRzTGlzdCIsImlucHV0U2VsZWN0b3IiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3NlbGVjdEJ1dHRvbiIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImJ1dHRvbiIsInNvbWUiLCJpbnB1dEVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJyZXNldFZhbGlkYXRpb24iLCJpdGVtcyIsInJlbmRlcmVyIiwiY29udGFpbmVyU2VsZWN0b3IiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZGF0YSIsImNhcmQiLCJhZGRJdGVtIiwiY2FyZEVsZW1lbnQiLCJwcmVwZW5kIiwiY2FyZFRlbXBsYXRlIiwiY29udGVudCIsImNhcmRzQ29udGFpbmVyIiwiY29uZmlnIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwb3B1cE5hbWUiLCJwb3B1cERlc2NyaXB0aW9uIiwicG9wdXBJbWFnZSIsInBvcHVwSW1hZ2VEZXNjcmlwdGlvbiIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiX2hhbmRsZUNsb3NlUG9wdXB3V2l0aE92ZXJsYXkiLCJldmVudCIsImtleSIsImNsb3NlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJzZXRFdmVudExpc3RlbmVycyIsIm9wZW4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiUG9wdXAiLCJzdWJtaXRIYW5kbGVyIiwic3VwZXIiLCJfc3VibWl0SGFuZGxlciIsIl9mb3JtIiwiZ2V0SW5wdXRzVmFsdWVzIiwiaW5wdXRzIiwiaW5wdXRzVmFsdWVzIiwibmFtZSIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJyZXNldCIsImN1c3RvbUZldGNoIiwidXJsIiwiaGVhZGVycyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXNUZXh0IiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiYXBpIiwiYmFzZVVybCIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRJbml0aWFsQ2FyZHMiLCJtZXRob2QiLCJnZXRVc2VySW5mbyIsImNyZWF0ZUNhcmQiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsImRpc2xpa2VDYXJkIiwiYXV0aG9yaXphdGlvbiIsInVzZXJJZCIsImltYWdlUG9wdXAiLCJjYXJkRGF0YSIsImNvbnN0YW50cyIsImxpbmsiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImFkZENhcmRGb3JtVmFsaWRhdG9yIiwiU2VjdGlvbiIsImFkZE5ld0NhcmQiLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwiYWJvdXQiLCJfaWQiLCJwb3B1cEFza0ZvckRlbGV0ZSIsInNldEFjdGlvbiIsImFjdGlvbiIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVMaWtlSWNvbiIsIl90ZW1wbGF0ZSIsIl9uYW1lIiwiX2xpbmsiLCJfb3duZXJJZCIsIm93bmVyIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVMaWtlSWNvbiIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX3VzZXJJZCIsIl9saWtlcyIsImxpa2VzIiwiX2NhcmQiLCJzdHlsZSIsImRpc3BsYXkiLCJyZW1vdmVDYXJkIiwiY2xvbmVOb2RlIiwiaW1nIiwibGVuZ3RoIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJfam9iIiwibmV3Q2FyZERhdGEiLCJwb3B1cFdpdGhQcm9maWxlIiwiUG9wdXBXaXRoRm9ybSIsInVzZXJEYXRhIiwicG9wdXBXaXRoQWRkQ2FyZCIsIml0ZW0iXSwic291cmNlUm9vdCI6IiJ9