!function(){"use strict";class e{constructor(e,t){this._settings=e,this._formElement=document.querySelector(`${t}`)}_showErrorMessage(e,t){const{inputErrorClass:s,errorClass:r}=this._settings;this._errorElement=this._formElement.querySelector(`.${e.id}-error`),this._errorElement.textContent=t,this._errorElement.classList.add(s),e.classList.add(r)}_hideErrorMessage(e){const{inputErrorClass:t,errorClass:s}=this._settings;this._errorElement=this._formElement.querySelector(`.${e.id}-error`),this._errorElement.textContent="",this._errorElement.classList.remove(t),e.classList.remove(s)}_checkInputValidity(e){if(e.validity.valid)this._hideErrorMessage(e);else{const t=e.validationMessage;this._showErrorMessage(e,t)}}_inputsList(){const{inputSelector:e}=this._settings;return Array.from(this._formElement.querySelectorAll(e))}_selectButton(){const{submitButtonSelector:e}=this._settings;return this._formElement.querySelector(e)}_toggleButtonState(){const{inactiveButtonClass:e}=this._settings,t=this._selectButton();this._inputsList().some((e=>!e.validity.valid))?(t.classList.add(e),t.setAttribute("disabled",!0)):(t.classList.remove(e),t.removeAttribute("disabled"))}_setEventListeners(){this._inputsList().forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{})),this._setEventListeners()}resetValidation(){const{inactiveButtonClass:e}=this._settings,t=this._selectButton();t.classList.add(e),t.setAttribute("disabled","true"),this._inputsList().forEach((e=>{this._hideErrorMessage(e)}))}}var t=class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}renderer(){this._items.forEach((e=>{const t=this._renderer(e);this.addItem(t)}))}addItem(e){this._container.prepend(e)}};const s=document.querySelector("#card-template").content,r=".cards__container",i={inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disable",inputErrorClass:"popup__input_type_error",errorClass:"popup__input_error-visible"},n=document.querySelector(".profile__name"),o=document.querySelector(".profile__description"),a=document.querySelector(".popup__input_content_name"),l=document.querySelector(".popup__input_content_description"),d=document.querySelector(".popup__image"),c=document.querySelector(".popup__image-description");var _=class{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this._handleClosePopupwWithOverlay=this._handleClosePopupwWithOverlay.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleClosePopupwWithOverlay(e){e.target.classList.contains("popup_open")&&this.close()}setEventListeners(){this._popup.querySelector(".popup__close-button").addEventListener("click",(()=>{this.close()}))}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._handleClosePopupwWithOverlay)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("mousedown",this._handleClosePopupwWithOverlay)}},h=class extends _{constructor(e,t){super(e),this._submitHandler=t,this._form=this._popup.querySelector(".popup__form")}getInputsValues(){const e=Array.from(this._form.querySelectorAll(".popup__input")),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler()}))}close(){super.close(),this._form.reset()}};const u=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject(e.statusText))).catch((e=>console.log(e))),p=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}getInitialCards(){return u(`${this._baseUrl}/cards`,{headers:this._headers,method:"GET"})}getUserInfo(){return u(`${this._baseUrl}/users/me`,{headers:this._headers,method:"GET"})}setUserInfo(e){return u(`${this._baseUrl}/users/me`,{headers:this._headers,mathod:"PATCH",body:JSON.stringify(e)})}createCard(e){return u(`${this._baseUrl}/cards`,{headers:this._headers,method:"POST",body:JSON.stringify(e)})}deleteCard(e){return u(`${this._baseUrl}/cards/${e}`,{headers:this._headers,method:"DELETE"})}likeCard(e){return u(`${this._baseUrl}/cards/likes/${e}`,{headers:this._headers,method:"PUT"})}dislikeCard(e){return u(`${this._baseUrl}/cards/likes/${e}`,{headers:this._headers,method:"DELETE"})}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"38a23878-64ce-4abb-ae0d-d30d11cc9a38","Content-Type":"application/json"}});let m;const E=new class extends _{open(e){super.open(),d.src=e.link,d.alt=e.name,c.textContent=e.name}}(".popup_type_image");E.setEventListeners();const v=new e(i,".popup__form_profile"),C=new e(i,".popup__form_add-card");v.enableValidation(),C.enableValidation(),p.getInitialCards().then((e=>{new t({items:e,renderer:b},r).renderer()})),p.getUserInfo().then((e=>{console.log(e),y.setUserInfo({name:e.name,about:e.about}),m=e._id}));const k=new class extends _{setAction(e){this._submitHandler=e}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler(),this.close()}))}}(".popup_type_delete-card");k.setEventListeners();const b=e=>{const t=new class{constructor({data:e,handleCardClick:t,handleDeleteCard:s,handleLikeIcon:r},i,n){this._template=i,this._name=e.name,this._link=e.link,this._ownerId=e.owner._id,this._handleCardClick=t,this._handleLikeIcon=r,this._handleDeleteCard=s,this._userId=n,this._likes=e.likes,this._cardId=e._id}_setEventListeners(){this._card.querySelector(".cards__like-button").addEventListener("click",(()=>this._handleLikeIcon(this._cardId,this._userId,this._likes))),this._card.querySelector(".cards__delete-button").addEventListener("click",(()=>this._handleDeleteCard(this._userId))),this._ownerId!==this._userId&&(this._card.querySelector(".cards__delete-button").style.display="none");const e={name:this._name,link:this._link};this._card.querySelector(".cards__image").addEventListener("click",(()=>{this._handleCardClick(e)}))}removeCard(){this._card.remove(),this._card=null}likeCard(e){this._likes=e,this._card.querySelector(".cards__like-button").classList.add("cards__like-button_active"),this._card.querySelector(".cards__likes-counter").textContent=this._likes.length}dislikeCard(e){this._likes=e,this._card.querySelector(".cards__like-button").classList.remove("cards__like-button_active"),this._card.querySelector(".cards__likes-counter").textContent=this._likes.length}createCard(){const e=this._template.querySelector(".cards__card").cloneNode(!0),t=e.querySelector(".cards__image");return t.setAttribute("src",this._link),t.setAttribute("alt",this._name),e.querySelector(".cards__header").textContent=this._name,this._card=e,this._card.querySelector(".cards__likes-counter").textContent=this._likes.length,this._likes.some((e=>e._id===this._userId))&&this.likeCard(this._likes),this._setEventListeners(),this._card}}({data:e,handleCardClick:()=>{E.open(e)},handleLikeIcon:(e,s,r)=>{r.find((e=>e._id===s))?p.dislikeCard(e).then((e=>{t.dislikeCard(e.likes),console.log("Removed like from card: ",e.likes)})):p.likeCard(e).then((e=>{t.likeCard(e.likes),console.log("Added like to card: ",e.likes)}))},handleDeleteCard:()=>{k.open(),k.setEventListeners(),k.setAction((()=>{p.deleteCard(e._id).then((e=>{console.log("card is deleted",e),t.removeCard()}))}))}},s,m);return t.createCard()},y=new class{constructor(e,t){this._name=e,this._job=t}getUserInfo(){return{name:this._name.textContent,about:this._job.textContent}}setUserInfo(e){this._name.textContent=e.name,this._job.textContent=e.about}}(n,o),L=new h(".popup_type_edit-profile",(()=>{let e=L.getInputsValues();y.setUserInfo(e),p.setUserInfo(e).then((e=>{console.log("res",e)})),L.close()}));L.setEventListeners(),document.querySelector(".profile__edit-button").addEventListener("click",(()=>{L.open();const e=y.getUserInfo(n,o);a.value=e.name,l.value=e.about,v.resetValidation()}));const g=new h(".popup_type_add-card",(()=>{const e=g.getInputsValues();p.createCard(e).then((e=>{new t({item:e,renderer:b},r).addItem(b(e)),g.close()}))}));g.setEventListeners(),document.querySelector(".profile__add-button").addEventListener("click",(()=>{g.open(),C.resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFpQixTQUFTLEtBQ3hDcUksRUFBaUJqRyxPQUNqQnFELEVBQXFCdEYscUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LW1haW4vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQtbWFpbi8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC1tYWluLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LW1haW4vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQtbWFpbi8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQtbWFpbi8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC1tYWluLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQtbWFpbi8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LW1haW4vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80LW1haW4vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC1tYWluLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gU3ByaW50IDcgLSBwcm9qZWN0IExpdmUgQ29kaW5nLCBMaXphIC0gdGltZSBvbiB2aWRlbzogMDowMCAtIDQwOjAwIG1pbnMuXG5cbmNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgJHtmb3JtRWxlbWVudH1gKTtcbiAgfVxuXG4gIF9zaG93RXJyb3JNZXNzYWdlKGlucHV0LCBlcnJvck1lc3NhZ2UpIHtcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JDbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXQuaWR9LWVycm9yYCk7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZChlcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlRXJyb3JNZXNzYWdlKGlucHV0KSB7XG4gICAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIGVycm9yQ2xhc3MgfSA9IHRoaXMuX3NldHRpbmdzO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0LmlkfS1lcnJvcmApO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5wdXRFcnJvckNsYXNzKTtcbiAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKGVycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCkge1xuICAgIGlmICghaW5wdXQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgICAgdGhpcy5fc2hvd0Vycm9yTWVzc2FnZShpbnB1dCwgZXJyb3JNZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUVycm9yTWVzc2FnZShpbnB1dCk7XG4gICAgfVxuICB9XG5cbiAgX2lucHV0c0xpc3QoKSB7XG4gICAgY29uc3QgeyBpbnB1dFNlbGVjdG9yIH0gPSB0aGlzLl9zZXR0aW5ncztcbiAgICBjb25zdCBpbnB1dHNMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoaW5wdXRTZWxlY3RvcilcbiAgICApO1xuICAgIHJldHVybiBpbnB1dHNMaXN0O1xuICB9XG5cbiAgX3NlbGVjdEJ1dHRvbigpIHtcbiAgICBjb25zdCB7IHN1Ym1pdEJ1dHRvblNlbGVjdG9yIH0gPSB0aGlzLl9zZXR0aW5ncztcbiAgICBjb25zdCBidXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICByZXR1cm4gYnV0dG9uO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGNvbnN0IHsgaW5hY3RpdmVCdXR0b25DbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XG4gICAgY29uc3QgYnV0dG9uID0gdGhpcy5fc2VsZWN0QnV0dG9uKCk7XG4gICAgY29uc3QgaW5wdXRMaXN0ID0gdGhpcy5faW5wdXRzTGlzdCgpO1xuICAgIGNvbnN0IGlzRm9ybUludmFsaWQgPSBpbnB1dExpc3Quc29tZShcbiAgICAgIChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcbiAgICApO1xuICAgIGlmICghaXNGb3JtSW52YWxpZCkge1xuICAgICAgYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICBidXR0b24ucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBjb25zdCBpbnB1dHNMaXN0ID0gdGhpcy5faW5wdXRzTGlzdCgpO1xuICAgIGlucHV0c0xpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7fSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICBjb25zdCB7IGluYWN0aXZlQnV0dG9uQ2xhc3MgfSA9IHRoaXMuX3NldHRpbmdzO1xuICAgIGNvbnN0IGJ1dHRvbiA9IHRoaXMuX3NlbGVjdEJ1dHRvbigpO1xuICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcInRydWVcIik7XG4gICAgY29uc3QgaW5wdXRzTGlzdCA9IHRoaXMuX2lucHV0c0xpc3QoKTtcbiAgICBpbnB1dHNMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUVycm9yTWVzc2FnZShpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCB7IEZvcm1WYWxpZGF0b3IgfTtcbiIsImNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIC8vIFB1YmxpYyBtZXRob2QgdGhhdCByZW5kZXJzIGFsbCBlbGVtZW50cyBvbiB0aGUgcGFnZS5cbiAgcmVuZGVyZXIoKSB7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoZGF0YSkgPT4ge1xuICAgICAgY29uc3QgY2FyZCA9IHRoaXMuX3JlbmRlcmVyKGRhdGEpO1xuICAgICAgdGhpcy5hZGRJdGVtKGNhcmQpO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gUHVibGljIG1ldGhvZCB0aGF0IHRha2VzIGEgRE9NIGVsZW1lbnQgYW5kIGFkZHMgaXQgdG8gdGhlIGNvbnRhaW5lci5cbiAgYWRkSXRlbShjYXJkRWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGNhcmRFbGVtZW50KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTZWN0aW9uO1xuIiwiLy8gaW1wb3J0IGhhdmFuYSBmcm9tICcuLi9pbWFnZXMvaGF2YW5hLmpwZyc7XG4vLyBpbXBvcnQgdmluYWxlcyBmcm9tICcuLi9pbWFnZXMvdmluYWxlcy5qcGcnO1xuLy8gaW1wb3J0IHBlbGljYW4gZnJvbSAnLi4vaW1hZ2VzL3BlbGljYW4uanBnJ1xuLy8gaW1wb3J0IGFyZGVhSGVyb2RpYXMgZnJvbSAnLi4vaW1hZ2VzL2FyZGVhLWhlcm9kaWFzLmpwZyc7XG4vLyBpbXBvcnQgdmlld0Zyb21NYW5hcmEgZnJvbSAnLi4vaW1hZ2VzL3ZpZXctZnJvbS1tYW5hcmEuanBnJztcbi8vIGltcG9ydCBiaXJpeWFGb3Jlc3QgZnJvbSAnLi4vaW1hZ2VzL2Jpcml5YS1mb3Jlc3QuanBnJztcblxuLy8gSW5pdGlhbGl6YXRpb24gY2FyZHMgb24gbG9hZGluZyBwYWdlLlxuLy8gZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiT2xkaWVzIGNhcnMgaW4gSGF2YW5hLCBDdWJhLlwiLFxuLy8gICAgIGxpbms6IGhhdmFuYVxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJUb2JhY2NvIGZpZWxkIGluIFZpw7FhbGVzIHZhbGxleSwgQ3ViYS5cIixcbi8vICAgICBsaW5rOiB2aW5hbGVzXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIlBlbGljYW4gaW4gYSBsYWtlLCBTYXJhc290YSBGTCwgVVNBLlwiLFxuLy8gICAgIGxpbms6IHBlbGljYW5cbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiR3JlYXQgYmx1ZSBoZXJvbiwgU2FyYXNvdGEgRkwsIFVTQS5cIixcbi8vICAgICBsaW5rOiBhcmRlYUhlcm9kaWFzXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIlNpZ2h0IGZyb20gTWFuYXJhIHRvIHNvdXRoZXJuIExlYmFub24gaW4gd2ludGVyICwgSXNyYWVsLlwiLFxuLy8gICAgIGxpbms6IHZpZXdGcm9tTWFuYXJhXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIkJpcml5YSBmb3Jlc3QsIFplZmF0LCBJc3JhZWxcIixcbi8vICAgICBsaW5rOiBiaXJpeWFGb3Jlc3Rcbi8vICAgfVxuLy8gXTtcblxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50O1xuZXhwb3J0IGNvbnN0IGNhcmRzQ29udGFpbmVyID0gXCIuY2FyZHNfX2NvbnRhaW5lclwiO1xuXG4vLyBGb3JtIFZhbGlkYXRpb24gY2xhc3Nlcy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX3N1Ym1pdC1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF9lcnJvci12aXNpYmxlXCIsXG59O1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZUZvcm1Qb3B1cCA9IFwiLnBvcHVwX19mb3JtX3Byb2ZpbGVcIjtcbmV4cG9ydCBjb25zdCBwcm9maWxlRm9ybVBvcHVwU2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZVwiO1xuZXhwb3J0IGNvbnN0IGNhcmRGb3JtUG9wdXAgPSBcIi5wb3B1cF9fZm9ybV9hZGQtY2FyZFwiO1xuZXhwb3J0IGNvbnN0IGNhcmRGb3JtUG9wdXBTZWxlY3RvciA9IFwiLnBvcHVwX3R5cGVfYWRkLWNhcmRcIjtcbmV4cG9ydCBjb25zdCBwb3B1cEZvckRlbGV0ZUNhcmQgPSBcIi5wb3B1cF90eXBlX2RlbGV0ZS1jYXJkXCI7XG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIlxuKTtcbmV4cG9ydCBjb25zdCBwb3B1cE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF9jb250ZW50X25hbWVcIik7XG5leHBvcnQgY29uc3QgcG9wdXBEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnBvcHVwX19pbnB1dF9jb250ZW50X2Rlc2NyaXB0aW9uXCJcbik7XG5cbi8vIEltYWdlIHBvcHVwLlxuZXhwb3J0IGNvbnN0IHBvcHVwVHlwZUltYWdlU2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX2ltYWdlXCI7XG4vLyBleHBvcnQgY29uc3QgcG9wdXBUeXBlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfaW1hZ2VcIik7XG5leHBvcnQgY29uc3QgcG9wdXBJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xuZXhwb3J0IGNvbnN0IHBvcHVwSW1hZ2VEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnBvcHVwX19pbWFnZS1kZXNjcmlwdGlvblwiXG4pO1xuIiwiY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKHtkYXRhLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZURlbGV0ZUNhcmQsIGhhbmRsZUxpa2VJY29ufSwgY2FyZFRlbXBsYXRlLCB1c2VySWQpIHtcbiAgICB0aGlzLl90ZW1wbGF0ZSA9IGNhcmRUZW1wbGF0ZTtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbiA9IGhhbmRsZUxpa2VJY29uO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQgPSBoYW5kbGVEZWxldGVDYXJkO1xuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XG4gICAgdGhpcy5fY2FyZElkID0gZGF0YS5faWQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgLy8gTGlrZSBidXR0b25zLlxuICAgIHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlrZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUljb24odGhpcy5fY2FyZElkLCB0aGlzLl91c2VySWQsIHRoaXMuX2xpa2VzKSk7XG5cbiAgICAvLyBEZWxldGUgYnV0dG9ucy5cbiAgICB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2RlbGV0ZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcy5fdXNlcklkKSk7XG4gICAgaWYodGhpcy5fb3duZXJJZCAhPT0gdGhpcy5fdXNlcklkKSB7XG4gICAgICB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2RlbGV0ZS1idXR0b25cIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgIH1cblxuICAgIC8vIFNob3cgaW1hZ2UgYXMgcG9wdXAuXG4gICAgY29uc3QgY2FyZERhdGEgPSB7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfTtcbiAgICB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2ltYWdlXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKGNhcmREYXRhKTtcbiAgICAgIH0pO1xuICB9XG4gICAgXG4gIHJlbW92ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkID0gbnVsbDtcbiAgfVxuXG4gIGxpa2VDYXJkKG5ld0xpa2VzKSB7XG4gICAgdGhpcy5fbGlrZXMgPSBuZXdMaWtlcztcbiAgICB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpa2UtYnV0dG9uXCIpLmNsYXNzTGlzdC5hZGQoXCJjYXJkc19fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlrZXMtY291bnRlclwiKS50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgfVxuICBkaXNsaWtlQ2FyZChuZXdMaWtlcykge1xuICAgIHRoaXMuX2xpa2VzID0gbmV3TGlrZXM7XG4gICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saWtlLWJ1dHRvblwiKS5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZHNfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpa2VzLWNvdW50ZXJcIikudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gIH1cblxuICBjcmVhdGVDYXJkKCkge1xuICAgIGNvbnN0IGNhcmQgPSB0aGlzLl90ZW1wbGF0ZVxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2NhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgY29uc3QgaW1nID0gY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19pbWFnZVwiKTtcbiAgICBpbWcuc2V0QXR0cmlidXRlKFwic3JjXCIsIHRoaXMuX2xpbmspO1xuICAgIGltZy5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgdGhpcy5fbmFtZSk7XG5cbiAgICBjb25zdCBjYXJkVGl0bGUgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2hlYWRlclwiKTtcbiAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgdGhpcy5fY2FyZCA9IGNhcmQ7XG4gICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saWtlcy1jb3VudGVyXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoIFxuICAgIFxuICAgIGxldCBpc0xpa2VkID0gdGhpcy5fbGlrZXMuc29tZShwZXJzb24gPT4gcGVyc29uLl9pZCA9PT0gdGhpcy5fdXNlcklkKVxuICAgIGlmIChpc0xpa2VkKSB7XG4gICAgICB0aGlzLmxpa2VDYXJkKHRoaXMuX2xpa2VzKVxuICAgIH1cblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmQ7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcbiIsImNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5faGFuZGxlQ2xvc2VQb3B1cHdXaXRoT3ZlcmxheSA9XG4gICAgICB0aGlzLl9oYW5kbGVDbG9zZVBvcHVwd1dpdGhPdmVybGF5LmJpbmQodGhpcyk7XG4gIH1cblxuICAvLyBQcml2YXRlIG1ldGhvZCB0aGF0IGNsb3NlIHBvcHVwIHdpbmRvdyBieSBFc2NhcGUga2V5LlxuICBfaGFuZGxlRXNjQ2xvc2UoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgLy8gUHJpdmF0ZSBtZXRob2QgdGhhdCBjbG9zZSBwb3B1cCB3aW5kb3cgYnkgY2xpY2tpbmcgb24gdGhlIG92ZXJsYXkuXG4gIF9oYW5kbGVDbG9zZVBvcHVwd1dpdGhPdmVybGF5KGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9vcGVuXCIpKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgLy8gUHVibGljIG1ldGhvZCB0aGF0IGFkZHMgYW4gZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGNsb3NlIGljb24gb2YgdGhlIHBvcHVwLlxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlLWJ1dHRvblwiKTtcblxuICAgIGNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBQdWJsaWMgbWV0aG9kIHRoYXQgb3BlbiB0aGUgcG9wdXAgd2luZG93LlxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZUNsb3NlUG9wdXB3V2l0aE92ZXJsYXkpO1xuICB9XG5cbiAgLy8gUHVibGljIG1ldGhvZCB0aGF0IGNsb3NlIHRoZSBwb3B1cCB3aW5kb3cuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZUNsb3NlUG9wdXB3V2l0aE92ZXJsYXkpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIHN1Ym1pdEhhbmRsZXIpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTsgLy8gdGhpcy5fcG9wdXBcbiAgICB0aGlzLl9zdWJtaXRIYW5kbGVyID0gc3VibWl0SGFuZGxlcjtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgfVxuXG4gIC8vIFByaXZhdGUgbWV0aG9kIHdoaWNoIGNvbGxlY3QgZGF0YSBmcm9tIGFsbCB0aGUgaW5wdXQgZmllbGRzLlxuICBnZXRJbnB1dHNWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRzID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2lucHV0XCIpKTtcbiAgICBjb25zdCBpbnB1dHNWYWx1ZXMgPSB7fTtcbiAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0c1ZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dHNWYWx1ZXM7XG4gIH1cblxuICAvLyBNb2RpZmllcyB0aGUgcGFyZW50IG1ldGhvZCBhbmQgYWRkIGV2ZW50IGxpc3RlbmVyIHRvIGNsb3NlIGljb24gYW5kIHN1Ym1pdCBidXR0b24uXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5fc3VibWl0SGFuZGxlcigpO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gTW9kaWZpZXMgdGhlIHBhcmVudCBtZXRob2QgaW4gb3JkZXIgdG8gcmVzZXQgdGhlIGZvcm0gb25jZSB0aGUgcG9wdXAgaXMgY2xvc2VkLlxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xuIiwiY29uc3QgY3VzdG9tRmV0Y2ggPSAodXJsLCBoZWFkZXJzKSA9PlxyXG4gIGZldGNoKHVybCwgaGVhZGVycylcclxuICAgIC50aGVuKHJlcyA9PiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1c1RleHQpKVxyXG4gICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG5cclxuY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKHtiYXNlVXJsLCBoZWFkZXJzfSkge1xyXG4gICAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICB9XHJcblxyXG4gIC8vIG90aGVyIG1ldGhvZHMgZm9yIHdvcmtpbmcgd2l0aCB0aGUgQVBJXHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIG1ldGhvZDogJ0dFVCcgLy8gZGVmYXVsdCBvcHRpb25cclxuICAgIH0pXHJcbiAgfVxyXG4gIFxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgbWV0aG9kOiAnR0VUJ1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKGRhdGEpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIG1hdGhvZDogJ1BBVENIJyxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGNyZWF0ZUNhcmQoZGF0YSkge1xyXG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsIFxyXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycywgXHJcbiAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycywgXHJcbiAgICAgICAgbWV0aG9kOiAnUFVUJyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBkaXNsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycywgXHJcbiAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpOyIsImltcG9ydCAnLi9pbmRleC5jc3MnO1xuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCB7XG4gIGNhcmRUZW1wbGF0ZSxcbiAgcHJvZmlsZUZvcm1Qb3B1cCxcbiAgY29uZmlnLFxuICBjYXJkRm9ybVBvcHVwLFxuICBjYXJkc0NvbnRhaW5lcixcbiAgaW5pdGlhbENhcmRzLFxuICBwcm9maWxlRm9ybVBvcHVwU2VsZWN0b3IsXG4gIGNhcmRGb3JtUG9wdXBTZWxlY3RvcixcbiAgcHJvZmlsZU5hbWUsXG4gIHByb2ZpbGVEZXNjcmlwdGlvbixcbiAgcG9wdXBUeXBlSW1hZ2VTZWxlY3RvcixcbiAgcG9wdXBOYW1lLFxuICBwb3B1cERlc2NyaXB0aW9uLFxuICBwb3B1cEZvckRlbGV0ZUNhcmRcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoU3VibWl0IGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0JztcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuXG4vLyBUb2tlbjogMzhhMjM4NzgtNjRjZS00YWJiLWFlMGQtZDMwZDExY2M5YTM4IEdyb3VwIElEOiBncm91cC0xMlxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCIzOGEyMzg3OC02NGNlLTRhYmItYWUwZC1kMzBkMTFjYzlhMzhcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICB9XG59KTtcblxubGV0IHVzZXJJZDtcblxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShwb3B1cFR5cGVJbWFnZVNlbGVjdG9yKTtcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVGb3JtUG9wdXApO1xuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGNhcmRGb3JtUG9wdXApO1xuXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hZGRDYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmFwaS5nZXRJbml0aWFsQ2FyZHMoKVxuLnRoZW4oaXRlbXMgPT4ge1xuICBjb25zdCBjYXJkcyA9IG5ldyBTZWN0aW9uKHsgaXRlbXMsIHJlbmRlcmVyOiBhZGROZXdDYXJkIH0sIGNhcmRzQ29udGFpbmVyKTtcbiAgY2FyZHMucmVuZGVyZXIoKTtcbn0pXG5cbmFwaS5nZXRVc2VySW5mbygpXG4gIC50aGVuKHJlcyA9PiB7XG4gICAgY29uc29sZS5sb2cocmVzKTtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7bmFtZTogcmVzLm5hbWUsIGFib3V0OiByZXMuYWJvdXR9KVxuICAgIHVzZXJJZCA9IHJlcy5faWRcbiAgfSlcblxuXG4gIGNvbnN0IHBvcHVwQXNrRm9yRGVsZXRlID0gbmV3IFBvcHVwV2l0aFN1Ym1pdChwb3B1cEZvckRlbGV0ZUNhcmQpO1xuICBwb3B1cEFza0ZvckRlbGV0ZS5zZXRFdmVudExpc3RlbmVycygpXG5cbmNvbnN0IGFkZE5ld0NhcmQgPSAoZGF0YSkgPT4ge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoe1xuICAgIGRhdGEsXG4gICAgaGFuZGxlQ2FyZENsaWNrOiAoKSA9PiB7XG4gICAgICBpbWFnZVBvcHVwLm9wZW4oZGF0YSk7XG4gICAgfSxcbiAgICBoYW5kbGVMaWtlSWNvbjogKGNhcmRJZCwgdXNlcklkLCBsaWtlc0FycmF5KSA9PiB7XG4gICAgICBpZiAoIWxpa2VzQXJyYXkuZmluZCh1c2VyID0+IHVzZXIuX2lkID09PSB1c2VySWQgKSkge1xuICAgICAgICBhcGkubGlrZUNhcmQoY2FyZElkKVxuICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgY2FyZC5saWtlQ2FyZChyZXMubGlrZXMpXG4gICAgICAgICAgY29uc29sZS5sb2coXCJBZGRlZCBsaWtlIHRvIGNhcmQ6IFwiLCByZXMubGlrZXMpO1xuICAgICAgICB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXBpLmRpc2xpa2VDYXJkKGNhcmRJZClcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgIGNhcmQuZGlzbGlrZUNhcmQocmVzLmxpa2VzKVxuICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVtb3ZlZCBsaWtlIGZyb20gY2FyZDogXCIsIHJlcy5saWtlcyk7XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSxcbiAgICBoYW5kbGVEZWxldGVDYXJkOiAoKSA9PiB7XG4gICAgICBwb3B1cEFza0ZvckRlbGV0ZS5vcGVuKCk7XG4gICAgICBwb3B1cEFza0ZvckRlbGV0ZS5zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgcG9wdXBBc2tGb3JEZWxldGUuc2V0QWN0aW9uKCgpID0+IHtcbiAgICAgICAgYXBpLmRlbGV0ZUNhcmQoZGF0YS5faWQpXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJjYXJkIGlzIGRlbGV0ZWRcIiwgcmVzKTtcbiAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xuICAgICAgICAgIH0pXG4gICAgICB9KVxuICAgIH1cbiAgfSwgY2FyZFRlbXBsYXRlLCB1c2VySWQpO1xuICByZXR1cm4gY2FyZC5jcmVhdGVDYXJkKCk7XG59O1xuXG4vLyBQb3B1cCBmb3IgcHJvZmlsZSBkZXRhaWxzIGZvcm0uXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhwcm9maWxlTmFtZSwgcHJvZmlsZURlc2NyaXB0aW9uKTtcbmNvbnN0IHBvcHVwV2l0aFByb2ZpbGUgPSBuZXcgUG9wdXBXaXRoRm9ybShwcm9maWxlRm9ybVBvcHVwU2VsZWN0b3IsICgpID0+IHtcbiAgbGV0IHByb2ZpbGVEYXRhID0gcG9wdXBXaXRoUHJvZmlsZS5nZXRJbnB1dHNWYWx1ZXMoKTtcbiAgdXNlckluZm8uc2V0VXNlckluZm8ocHJvZmlsZURhdGEpO1xuICBhcGkuc2V0VXNlckluZm8ocHJvZmlsZURhdGEpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJyZXNcIiwgcmVzKTtcbiAgICB9KVxuICBwb3B1cFdpdGhQcm9maWxlLmNsb3NlKCk7XG59KTtcblxucG9wdXBXaXRoUHJvZmlsZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBvcGVuRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5vcGVuRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBwb3B1cFdpdGhQcm9maWxlLm9wZW4oKTtcbiAgY29uc3QgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbyhwcm9maWxlTmFtZSwgcHJvZmlsZURlc2NyaXB0aW9uKTtcbiAgcG9wdXBOYW1lLnZhbHVlID0gdXNlckRhdGEubmFtZTtcbiAgcG9wdXBEZXNjcmlwdGlvbi52YWx1ZSA9IHVzZXJEYXRhLmFib3V0O1xuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbn0pO1xuXG4vLyBQb3B1cCBmb3IgYWRkIGNhcmQgZm9ybS5cbmNvbnN0IHBvcHVwV2l0aEFkZENhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybShjYXJkRm9ybVBvcHVwU2VsZWN0b3IsICgpID0+IHtcbiAgY29uc3QgZGF0YSA9IHBvcHVwV2l0aEFkZENhcmQuZ2V0SW5wdXRzVmFsdWVzKClcbiAgXG4gIGFwaS5jcmVhdGVDYXJkKGRhdGEpXG4gICAgLnRoZW4oaXRlbSA9PiB7XG4gICAgICBjb25zdCBjYXJkcyA9IG5ldyBTZWN0aW9uKHsgaXRlbSwgcmVuZGVyZXI6IGFkZE5ld0NhcmQgfSwgY2FyZHNDb250YWluZXIpO1xuICAgICAgY2FyZHMuYWRkSXRlbShhZGROZXdDYXJkKGl0ZW0pKTtcbiAgICAgIHBvcHVwV2l0aEFkZENhcmQuY2xvc2UoKTtcbiAgICB9KTtcbn0pXG4gIFxucG9wdXBXaXRoQWRkQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBvcGVuQWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5vcGVuQWRkQ2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcG9wdXBXaXRoQWRkQ2FyZC5vcGVuKCk7XG4gIGFkZENhcmRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcbmltcG9ydCAqIGFzIGNvbnN0YW50cyBmcm9tIFwiLi4vLi4vc3JjL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgb3BlbihjYXJkRGF0YSkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICBjb25zdGFudHMucG9wdXBJbWFnZS5zcmMgPSBjYXJkRGF0YS5saW5rO1xuICAgIGNvbnN0YW50cy5wb3B1cEltYWdlLmFsdCA9IGNhcmREYXRhLm5hbWU7XG4gICAgY29uc3RhbnRzLnBvcHVwSW1hZ2VEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGNhcmREYXRhLm5hbWU7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoSW1hZ2U7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aFN1Ym1pdCBleHRlbmRzIFBvcHVwIHtcclxuICBzZXRBY3Rpb24oYWN0aW9uKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIgPSBhY3Rpb247XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5fc3VibWl0SGFuZGxlcigpO1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhTdWJtaXQ7IiwiaW1wb3J0IHsgcHJvZmlsZU5hbWUsIHByb2ZpbGVEZXNjcmlwdGlvbiB9IGZyb20gXCIuLi8uLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbmNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBqb2JTZWxlY3Rvcikge1xuICAgIHRoaXMuX25hbWUgPSBuYW1lU2VsZWN0b3I7XG4gICAgdGhpcy5fam9iID0gam9iU2VsZWN0b3I7XG4gIH1cblxuICAvLyBQdWJsaWMgbWV0aG9kIHdoaWNoIHJldHVybnMgYW4gb2JqZWN0IHdpdGggaW5mb3JtYXRpb24gYWJvdXQgdGhlIHVzZXIuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7IG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsIGFib3V0OiB0aGlzLl9qb2IudGV4dENvbnRlbnQgfTtcbiAgfVxuXG4gIC8vIFB1YmxpYyBtZXRob2Qgd2hpY2ggdGFrZXMgbmV3IHVzZXIgZGF0YSBhbmQgYWRkcyBpdCBvbiB0aGUgcGFnZS5cbiAgc2V0VXNlckluZm8obmV3RGF0YSkge1xuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuZXdEYXRhLm5hbWU7XG4gICAgdGhpcy5fam9iLnRleHRDb250ZW50ID0gbmV3RGF0YS5hYm91dDtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBVc2VySW5mbztcbiJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9zZXR0aW5ncyIsIl9mb3JtRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIl9zaG93RXJyb3JNZXNzYWdlIiwiaW5wdXQiLCJlcnJvck1lc3NhZ2UiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Vycm9yRWxlbWVudCIsImlkIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJfaGlkZUVycm9yTWVzc2FnZSIsInJlbW92ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaW5wdXRzTGlzdCIsImlucHV0U2VsZWN0b3IiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3NlbGVjdEJ1dHRvbiIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImJ1dHRvbiIsInNvbWUiLCJpbnB1dEVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJyZXNldFZhbGlkYXRpb24iLCJpdGVtcyIsInJlbmRlcmVyIiwiY29udGFpbmVyU2VsZWN0b3IiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZGF0YSIsImNhcmQiLCJhZGRJdGVtIiwiY2FyZEVsZW1lbnQiLCJwcmVwZW5kIiwiY2FyZFRlbXBsYXRlIiwiY29udGVudCIsImNhcmRzQ29udGFpbmVyIiwiY29uZmlnIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwb3B1cE5hbWUiLCJwb3B1cERlc2NyaXB0aW9uIiwicG9wdXBJbWFnZSIsInBvcHVwSW1hZ2VEZXNjcmlwdGlvbiIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiX2hhbmRsZUNsb3NlUG9wdXB3V2l0aE92ZXJsYXkiLCJldmVudCIsImtleSIsImNsb3NlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJzZXRFdmVudExpc3RlbmVycyIsIm9wZW4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiUG9wdXAiLCJzdWJtaXRIYW5kbGVyIiwic3VwZXIiLCJfc3VibWl0SGFuZGxlciIsIl9mb3JtIiwiZ2V0SW5wdXRzVmFsdWVzIiwiaW5wdXRzIiwiaW5wdXRzVmFsdWVzIiwibmFtZSIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJyZXNldCIsImN1c3RvbUZldGNoIiwidXJsIiwiaGVhZGVycyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXNUZXh0IiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiYXBpIiwiYmFzZVVybCIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRJbml0aWFsQ2FyZHMiLCJtZXRob2QiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwibWF0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjcmVhdGVDYXJkIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImxpa2VDYXJkIiwiZGlzbGlrZUNhcmQiLCJhdXRob3JpemF0aW9uIiwidXNlcklkIiwiaW1hZ2VQb3B1cCIsImNhcmREYXRhIiwiY29uc3RhbnRzIiwibGluayIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYWRkQ2FyZEZvcm1WYWxpZGF0b3IiLCJTZWN0aW9uIiwiYWRkTmV3Q2FyZCIsInVzZXJJbmZvIiwiYWJvdXQiLCJfaWQiLCJwb3B1cEFza0ZvckRlbGV0ZSIsInNldEFjdGlvbiIsImFjdGlvbiIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVMaWtlSWNvbiIsIl90ZW1wbGF0ZSIsIl9uYW1lIiwiX2xpbmsiLCJfb3duZXJJZCIsIm93bmVyIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVMaWtlSWNvbiIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX3VzZXJJZCIsIl9saWtlcyIsImxpa2VzIiwiX2NhcmRJZCIsIl9jYXJkIiwic3R5bGUiLCJkaXNwbGF5IiwicmVtb3ZlQ2FyZCIsIm5ld0xpa2VzIiwibGVuZ3RoIiwiY2xvbmVOb2RlIiwiaW1nIiwicGVyc29uIiwibGlrZXNBcnJheSIsImZpbmQiLCJ1c2VyIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJfam9iIiwibmV3RGF0YSIsInBvcHVwV2l0aFByb2ZpbGUiLCJQb3B1cFdpdGhGb3JtIiwicHJvZmlsZURhdGEiLCJ1c2VyRGF0YSIsInBvcHVwV2l0aEFkZENhcmQiLCJpdGVtIl0sInNvdXJjZVJvb3QiOiIifQ==